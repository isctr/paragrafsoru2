/*! Copyright 2012 Question Writer Corporation. All rights reserved. */
function APIQW(n){this.assessRef=n,this.loading=!0,this.sending=!1,this.finished=!1,this.responsesSent=!1,this.inReport=!1}function getStyleQW(n,t){return n.currentStyle?n.currentStyle[t]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(n,"")[t]:n.style[t]}function Preloader(n,t){this.maincontext=n,this.waitForLoad=t,this.nextURL="",this.assessmentready=!1,this.allImages=[];var i=this;this.theInterval=setInterval(function(){i.updateProgress()},50),this.imageLocationList=[],this.scriptLocationList=[],this.numberOfScriptsToLoad=0}function ResultsSending(n,t,i,r){this.assessRef=n,this.sendURL=t,this.altSendURL=i,this.sourceID=r,this.delaybetweensends=5,this.maxTries=0,this.maxTriesExceededMessage="Unable to send responses to server. Your responses have not been transmitted.",this.clientTime=(new Date).toString()}function CQSendResultsV1_0(n,t,i){if(this.assessmentRef=n,!this.assessmentRef.getAPIQWObject().isSending()){var f=i,r=this,u=function(){r.assessmentRef.setAnswers(t,[])};this.resultsSendingInterval=setInterval(u,1e3),this.assessmentRef.sendResults()}}function CQRandomV1_2(n,t){this.assessRef=n,this.fullyAnswered=!1;var r=this,u=function(){r.fullyAnswered=!0,r.assessRef.setAnswers(t,[])};setTimeout(u,50)}function Page(n,t,i,r,u){var o,f,s,h,e,c,l;for(this.assessmentRef=t,this.presentationHTML="",this.responseProcessingNode=null,this.itemFeedbacks={},this.thePopulateMatvars={},this.populateForms=[],this.populateFeedbacks=[],this.populateContent=[],this.processMathjax=!1,this.fullyAnswered=[],this.insideFeedback=!1,this.responseID="",this.renderType="",this.minNumber=0,this.maxNumber=0,this.ident=n.getAttribute("ident"),o="",n.getAttribute("htmlhint")!=null&&(o=n.getAttribute("htmlhint")),f=0;f<n.childNodes.length;f++)switch(n.childNodes[f].nodeName){case"presentation":s=this.processPresentation(n.childNodes[f]),s!=""&&(this.presentationHTML+="<div class='presentation "+o+"'>"+s+"<\/div>");case"resprocessing":this.responseProcessingNode=n.childNodes[f];break;case"itemfeedback":h=n.childNodes[f].getAttribute("ident"),this.itemFeedbacks[h]="<div class='itemfeedback "+o+"'>"+this.processItemfeedback(n.childNodes[f])+"<\/div>"}e=[],n.getAttribute("navhint")!=null&&(e=n.getAttribute("navhint").split(" ")),c="<button class='nextbutton nextbuttonbackground"+(QWUtils.useSVG()?"svg":"")+"' onclick='"+this.assessmentRef.javascriptID+".nextButtonClicked();' title='next' id='next' name='next' type='button' value='next'>"+r.encodeHTML()+"<\/button>",l="<button class='backbutton backbuttonbackground"+(QWUtils.useSVG()?"svg":"")+"' onclick='"+this.assessmentRef.javascriptID+".backButtonClicked();' title='back' id='back' name='back' type='button' value='back'>"+u.encodeHTML()+"<\/button>",this.initializeNextButtons(c,e),this.initializeBackButtons(l,e),e.contains("autoforward")?XMLMethods.addAttribute(this.assessmentRef.pCurrentNode,"autoforward","true"):XMLMethods.addAttribute(this.assessmentRef.pCurrentNode,"autoforward","false"),e.contains("forceattempt")&&XMLMethods.addAttribute(this.assessmentRef.pCurrentNode,"allowUnansweredForward","false")}function Assessment(n,t,i,r,u,f,e,o,s,h,c,l){var v=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,a=navigator.userAgent.toLowerCase(),y;if(v&&a.indexOf("safari/")!==-1&&a.indexOf("windows")!==-1){this.assessmentDiv=document.getElementById(n),this.assessmentDiv.innerHTML="<div>Oops! Looks like you are using Safari on Windows. This Browser/OS combination cannot be supported because its HTML5 Drag and Drop implementation does not work. Please use a different browser or OS.<\/div>";return}if((navigator.appVersion.indexOf("MSIE 7.")!=-1||navigator.appVersion.indexOf("MSIE 6.")!=-1)&&navigator.appVersion.indexOf("Trident")==-1){this.assessmentDiv=document.getElementById(n),this.assessmentDiv.innerHTML="<div>Oops! Looks like you are using an old version of Internet Explorer. Internet Explorer Version 8 and greater are supported. Please use a different browser. "+navigator.appVersion+"<\/div>";return}window.globals==null&&(window.globals={}),window.globals[n]=this,this.javascriptID="window.globals."+n,this.pXMLResults=null,this.pCurrentNode=null,this.pages={},this.loader=null,this.assessmentRubric="",this.questionJSID=1,this.inFeedback=!1,this.navForwardDirection=!0,this.seekBranchTarget=null,this.branchBackwards=!1,this.clickedNextButIsBeingBranchedBackwards=!1,this.processClickEvents=!0,this.nextButtonText="next",this.backButtonText="back",this.nextURL=l,this.timerManager=new QWTimerManager(this),this.theAPI=new APIQW(this),document.getElementById("qwhtml").className=document.getElementById("qwhtml").className+(navigator.appVersion.indexOf("MSIE 8.")!=-1?" ie8":""),this.assessmentDiv=document.getElementById(n),this.assessmentDiv.className="assessmentcontainer assessmentcontainerbackground"+(QWUtils.useSVG()?"svg":""),this.assessmentDiv.innerHTML="    "+(QWUtils.useSVG()?"":'<img src="images/bg.jpg" id="ie8backgroundtop" class="backgroundie8horizontalstretchtop">')+'    <div id="loader" class="loader loaderbackground'+(QWUtils.useSVG()?"svg":"")+'">        '+(QWUtils.useSVG()?"":'<img src="images/bg.jpg"  id="ie8backgroundloaderbottom" class="backgroundie8horizontalstretchbottom">')+'        <div id="loadercontent" class="loadercontent"><\/div>        <div id="loaderprogress" class="loaderprogress">Loading . . .<\/div>        <div id="resources" class="resources" style="display:none;"><\/div>    <\/div>    <div id="finished" class="finished finishedbackground'+(QWUtils.useSVG()?"svg":"")+'" style="display:none;" >        '+(QWUtils.useSVG()?"":'<img src="images/bg.jpg"  id="ie8backgroundfinishedbottom" class="backgroundie8horizontalstretchbottom">')+'        <div id="finishedcontent" class="finishedcontent"><\/div>    <\/div>    <div id="assessmentbackground" style="display:none;" class="assessmentbackground'+(QWUtils.useSVG()?"svg":"")+'">    '+(QWUtils.useSVG()?"":'<img src="images/bg.jpg"  id="ie8backgroundbottom" class="backgroundie8horizontalstretchbottom">')+'    <div id="header" class="header"><\/div>    <div id="assessmentrubric" class="assessmentrubric"><\/div>    <div id="content" class="questionarea"><\/div>    <div id="timer" class="timer"><\/div>    <nav class="navigationcontrols">        <div id="restartbutton" class="restartbuttoncontainer"><\/div>        <div id="backbutton" class="backbuttoncontainer"><\/div>        <div id="nextbutton" class="nextbuttoncontainer"><\/div>    <\/nav>    <div id="footer" class="footer"><\/div>    <\/div>',QWUtils.useSVG()||QWUtils.addCss("span > input[type=radio], span > input[type=checkbox]{opacity: 100;}"),QWUtils.useSVG()||(this.getNodeByID("ie8backgroundtop").src=this.assessmentDiv.currentStyle.backgroundImage.slice(5,-2),this.getNodeByID("ie8backgroundbottom").src=this.getNodeByID("assessmentbackground").currentStyle.backgroundImage.slice(5,-2),this.getNodeByID("ie8backgroundloaderbottom").src=this.getNodeByID("loader").currentStyle.backgroundImage.slice(5,-2),this.getNodeByID("ie8backgroundfinishedbottom").src=this.getNodeByID("finished").currentStyle.backgroundImage.slice(5,-2),this.assessmentDiv.style.overflow="inherit"),this.loader=new Preloader(this,r),this.sendingResults=new ResultsSending(this,s,h,c),this.assessmentGUID=f,this.loadAssessmentContent(u,i,t),e.toLowerCase()=="false"&&QWUtils.addWindowResizer(this.assessmentDiv.offsetWidth,this.assessmentDiv.offsetHeight),y=this,o&&(this.SCORMPageID=0,this.theSCORMCOMM=new SCORMcomms,this.theSCORMCOMM.init())}function QWTimerManager(n){this.assessref=n,this.timerDisplay=null,this.activeTimers=[];var t=this;setInterval(function(){t.checkTimers()},1e3)}function QWTimer(n){this.targetXMLNode=n,this.timelimit=this.targetXMLNode.getAttribute("timelimit"),this.targetXMLNode.setAttribute("starttime",""+ +new Date),this.updateTimer()}function Decvar(n,t,i,r,u){this.resultsDocNode=null,n==null?(this.name=i,this.vartype=r,this.members=u):(this.name=n.getAttribute("varname").toLowerCase(),this.value=n.getAttribute("defaultval"),this.members=[],n.getAttribute("members")!=null&&(this.members=n.getAttribute("members").split(",")),this.cutvalue=n.getAttribute("cutvalue"),this.minvalue=n.getAttribute("minvalue"),this.maxvalue=n.getAttribute("maxvalue"),this.vartype=n.getAttribute("vartype"),this.resultsDocNode=XMLMethods.makeNodeWithText(t,"score",""),XMLMethods.addAttribute(this.resultsDocNode,"varname",this.name),XMLMethods.addAttribute(this.resultsDocNode,"vartype",this.vartype)),this.ensureValueExists()}function Setvar(n,t){this.assessmentRef=t,this.varname=n.getAttribute("varname").toLowerCase(),this.action=n.getAttribute("action"),this.textVal=n.childNodes.length>0?n.childNodes[0].nodeValue:"",this.respident=n.getAttribute("respident"),this.index=n.getAttribute("index"),this.sourcevarname=n.getAttribute("sourcevarname"),this.correctanswer=n.getAttribute("correctanswer"),this.errormargin=n.getAttribute("errormargin"),(this.index==null||this.index=="")&&(this.index=0),this.varname==null&&(this.varname="score"),this.action==null&&(this.action="Set"),this.errormargin==null&&(this.errormargin="30")}function getDamerauLevenshteinDistance(n,t){for(var o=n.length,s=t.length,u=[],f,r,e,i=0;i<=o;i++){for(f=[],r=0;r<=s;r++)i!=0?f.push(0):f.push(r);f[0]=i,u.push(f)}for(i=1;i<=o;i++)for(r=1;r<=s;r++)e=n.charAt(i-1)==t.charAt(r-1)?0:1,u[i][r]=Math.min(Math.min(u[i-1][r]+1,u[i][r-1]+1),u[i-1][r-1]+e),i>1&&r>1&&n.charAt(i-1)==t.charAt(r-2)&&n.charAt(i-2)==t.charAt(r-1)&&(u[i][r]=Math.min(u[i][r],u[i-2][r-2]+e));return u[o][s]}function Outcomes(n,t){var i;for(this.decvars=[],this.resultOutcomesNode=null,i=0;i<t.childNodes.length;i++)if(t.childNodes[i].nodeName=="outcomes"){t.removeChild(t.childNodes[i]);break}if(this.resultOutcomesNode=XMLMethods.makeNode(t,"outcomes"),n!=null)for(i=0;i<n.childNodes.length;i++)n.childNodes[i].nodeName=="decvar"&&this.overwriteDecvar(new Decvar(n.childNodes[i],this.resultOutcomesNode))}function SuperConstruct(n,t){n.respident=t.getAttribute("respident"),t.getAttribute("index")!=null&&t.getAttribute("index")!=""&&(n.index=Number(t.getAttribute("index"))),n.textVal=t.childNodes[0].nodeValue,n.textVal==null&&(n.textVal=""),n.varname=t.getAttribute("varname")}function TokenAncestor(n){SuperConstruct(this,n)}function evaluate(n,t){var i,r;if(this.varname!=null&&this.varname!="")return this.testCondition(this.textVal,t.getScore(this.varname),t.getDuration(this.varname));if(i=t.getRespList(this.respident),this.index!=null){if(i.childNodes.length>=this.index)return this.testCondition(this.textVal,i.childNodes[this.index-1].firstChild.nodeValue,n)?!0:!1}else{for(r=0;r<i.childNodes.length;r++)if(this.testCondition(this.textVal,i.childNodes[r].firstChild.nodeValue,n))return!0;return!1}}function TAvarequal(n){SuperConstruct(this,n),this.caseInsensitive=n.getAttribute("case")=="Nocase"||n.getAttribute("case")=="nocase"||n.getAttribute("case")=="no"||n.getAttribute("case")=="No"?!0:!1}function TAvarlt(n){SuperConstruct(this,n)}function TAvarlte(n){SuperConstruct(this,n)}function TAvargt(n){SuperConstruct(this,n)}function TAvargte(n){SuperConstruct(this,n)}function TAdurequal(n){SuperConstruct(this,n)}function TAdurlt(n){SuperConstruct(this,n)}function TAdurlte(n){SuperConstruct(this,n)}function TAdurgt(n){SuperConstruct(this,n)}function TAdurgte(n){SuperConstruct(this,n)}function TAvarsubstring(n){SuperConstruct(this,n),this.caseInsensitive=n.getAttribute("case")=="Yes"||n.getAttribute("case")=="yes"?!1:!0}function TAvarsubset(n){SuperConstruct(this,n),this.caseInsensitive=n.getAttribute("setmatch")=="Partial"||n.getAttribute("setmatch")=="Partial"?!0:!1}function TAunanswered(n){SuperConstruct(this,n)}function TAother(){}function SASuperConstruct(n,t){n.listOfBools=[];for(var i=0;i<t.childNodes.length;i++)(t.childNodes[i].nodeName=="not"||t.childNodes[i].nodeName=="not_test")&&n.listOfBools.push(new LAnot(t.childNodes[i])),(t.childNodes[i].nodeName=="and"||t.childNodes[i].nodeName=="and_test")&&n.listOfBools.push(new LAand(t.childNodes[i])),(t.childNodes[i].nodeName=="or"||t.childNodes[i].nodeName=="or_test")&&n.listOfBools.push(new LAor(t.childNodes[i])),t.childNodes[i].nodeName=="varequal"&&n.listOfBools.push(new TAvarequal(t.childNodes[i])),t.childNodes[i].nodeName=="varlt"&&n.listOfBools.push(new TAvarlt(t.childNodes[i])),t.childNodes[i].nodeName=="varlte"&&n.listOfBools.push(new TAvarlte(t.childNodes[i])),t.childNodes[i].nodeName=="vargt"&&n.listOfBools.push(new TAvargt(t.childNodes[i])),t.childNodes[i].nodeName=="vargte"&&n.listOfBools.push(new TAvargte(t.childNodes[i])),t.childNodes[i].nodeName=="durequal"&&n.listOfBools.push(new TAdurequal(t.childNodes[i])),t.childNodes[i].nodeName=="durlt"&&n.listOfBools.push(new TAdurlt(t.childNodes[i])),t.childNodes[i].nodeName=="durlte"&&n.listOfBools.push(new TAdurlte(t.childNodes[i])),t.childNodes[i].nodeName=="durgt"&&n.listOfBools.push(new TAdurgt(t.childNodes[i])),t.childNodes[i].nodeName=="durgte"&&n.listOfBools.push(new TAdurgte(t.childNodes[i])),t.childNodes[i].nodeName=="varsubstring"&&n.listOfBools.push(new TAvarsubstring(t.childNodes[i])),t.childNodes[i].nodeName=="varsubset"&&n.listOfBools.push(new TAvarsubset(t.childNodes[i])),t.childNodes[i].nodeName=="other"&&n.listOfBools.push(new TAother(t.childNodes[i])),t.childNodes[i].nodeName=="unanswered"&&n.listOfBools.push(new TAunanswered(t.childNodes[i]))}function LogicAncestor(n){SASuperConstruct(this,n)}function ResponseProcessing(n,t,i){var r,e,o,f,u;for(this.theOutcomes=null,this.respconditionArray=[],this.feedbackDisplay=[],r=0;r<n.childNodes.length;r++)n.childNodes[r].nodeName=="outcomes"&&(this.theOutcomes=new Outcomes(n.childNodes[r],t)),n.childNodes[r].nodeName=="respcondition"&&this.respconditionArray.push(new Respcondition(n.childNodes[r],i));for(this.theOutcomes==null&&(this.theOutcomes=new Outcomes(null,t)),e=0,r=0;r<this.respconditionArray.length;r++)if(o=this.respconditionArray[r].evaluate(e,this.theOutcomes),this.feedbackDisplay=this.feedbackDisplay.concat(o),!this.respconditionArray[r].getShouldContinue())break;if(this.theOutcomes.truncate(),i.getSCORMComms())for(f=i.getPageIDForSCORM(this.theOutcomes.size()),r=0;r<this.theOutcomes.size();r++)u=[],u.push("LMSSetObjective"),u.push(""+f+r),u.push(""+i.getCurrentIdent()+"-"+this.theOutcomes.getAt(r).getName()),u.push(""+this.theOutcomes.getAt(r).getValue()),i.getSCORMComms().queueFS(u),u=[],u.push("LMSSetInteraction"),u.push(""+f+r),u.push(""+i.getCurrentIdent()+"-"+this.theOutcomes.getAt(r).getName()),u.push(""+this.theOutcomes.getAt(r).getValue()),u.push("performance"),u.push(""+SCORMcomms.getTimeString()),i.getSCORMComms().queueFS(u)}function Respcondition(n,t){this.assessmentRef=t,this.setvars=[],this.displays=[],this.branches=[],this.theContinue=!1,this.shouldContinue=!1,(n.getAttribute("continue").toLowerCase()=="yes"||n.getAttribute("continue").toLowerCase()=="true")&&(this.theContinue=!0);for(var i=0;i<n.childNodes.length;i++)n.childNodes[i].nodeName=="conditionvar"&&(this.condition=new LAand(n.childNodes[i])),n.childNodes[i].nodeName=="setvar"&&this.setvars.push(new Setvar(n.childNodes[i],this.assessmentRef)),n.childNodes[i].nodeName=="displayfeedback"&&(n.childNodes[i].getAttribute("feedbacktype")==null?this.displays.push(n.childNodes[i].getAttribute("linkrefid")):this.displays.push(n.childNodes[i].getAttribute("linkrefid")+n.childNodes[i].getAttribute("feedbacktype"))),n.childNodes[i].nodeName=="branch"&&this.branches.push(new Branch(n.childNodes[i]))}function MCbuttonHit(n,t,i,r,u){var o=XMLMethods.getFirstChildNodeWithNameAndAttribute(n.getCurrentNode(),"response","ident_ref",t),h=XMLMethods.getFirstChildNodeWithNameAndTextValue(o,"response_value","ident_ref",i),e,s,c,l;if(h!=null)o.removeChild(h),e=n.getNodeByID(t+i),e.checked=!1,e.blur();else{if(u<2&&(s=XMLMethods.getFirstChildNodeWithName(o,"response_value"),s!=null&&(c=s.firstChild.nodeValue,o.removeChild(s),n.getNodeByID(t+c).checked=!1)),l=o.childNodes.length,l>=u){e=n.getNodeByID(t+i),e.checked=!1,e.blur();return}e=n.getNodeByID(t+i),e.checked=!0,e.blur(),XMLMethods.makeNodeWithText(o,"response_value",i)}n.processFullyAnswered()}function populateMCQuestionWithResponses(n,t){for(var r=XMLMethods.getFirstChildNodeWithNameAndAttribute(n.getCurrentNode(),"response","ident_ref",t),u,i=0;i<r.childNodes.length;i++)u=r.childNodes[i].firstChild.nodeValue,n.getNodeByID(t+u).checked=!0}function MCisFullyAnswered(n,t,i){var r=XMLMethods.getFirstChildNodeWithNameAndAttribute(n.getCurrentNode(),"response","ident_ref",t),u=r.childNodes.length;return u>=i?!0:!1}function CQMatchingV1_1(n,t,i){var u,b,e,l,v;this.assessmentRef=n,this.respID=t,this.myPegBoard=null,this.idTable=[];var f=i,tt=Number(f._padding),y=f._slotColor,a=f._slotBorderColor,it=f._numberTextColor,k="#00FF00";f._answer==null||f._answer==undefined?this.isFeedback=!1:(this.isFeedback=!0,this.correctAnswerArray=f._answer.split(","),this.originalQuestionID=f._originalquestionid);var c=0,o=0,s=0,h=0,p=[],w=[],r=this.assessmentRef.getNodeByID(this.respID);for(this.idTable=[],u=0,b=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,u=0;u<r.childNodes.length;u++)e=b?document.createElement("span"):document.createElement("a"),l=QWUtils.makeGuid(),e.id=l,this.idTable[r.childNodes[u].id]=l,this.idTable[l]=r.childNodes[u].id,e.className="responselabeldynamic",e.href="#",r.childNodes[u].id="",r.insertBefore(e,r.childNodes[u]),e.appendChild(r.childNodes[u+1]);for(u=0;u<r.childNodes.length;u++)h++,h<=r.childNodes.length/2?(r.childNodes[u].offsetWidth>c&&(c=r.childNodes[u].offsetWidth),p.push(r.childNodes[u])):(r.childNodes[u].offsetWidth>o&&(o=r.childNodes[u].offsetWidth),w.push(r.childNodes[u])),r.childNodes[u].offsetHeight>s&&(s=r.childNodes[u].offsetHeight);if(v=5,this.myPegBoard=new PegBoard(this,r,5,1,v),this.assessmentRef.getAPIQWObject().getDirection()=="rtl"){var d=c+o*2+30+v*6+18,g=r.offsetWidth,nt=g-d;r.style.left=nt+"px"}this.myPegBoard.addColumn(h/2,c+10,s+10,0,y,a,50,"peg choice_box",p,!1,!1,!1,!1,!1,!0),this.myPegBoard.addColumn(h/2,o+10,s+10,12,y,a,50,"peg match_box",null,!1,!this.isFeedback,!0,!1,!1,!1),this.myPegBoard.addColumn(h/2,o+10,s+10,6,k,a,this.isFeedback?50:0,this.isFeedback?"peg correct_box":"peg stand_box",w,!this.isFeedback,!this.isFeedback,!1,!0,!1,!1),this.myPegBoard.createSpacerCanvasForDocumentFlow(),this.putAnswersInPlace(),this.updateAnswers(!1)}function QWFIBV1_0(n,t,i){var s,u,r,h,c;this.assessmentRef=n;var f=i,e=Number(f._rows),o=Number(f._columns);this.responseID=t,s="",u=this.assessmentRef.getNodeByID(this.responseID+"a"),s="",u.innerHTML=e=="1"?"<input class='fibinput' type='input' size='"+o+"' id='"+this.responseID+"'/>":"<textarea class='fibinput essay'  rows='"+e+"' columns='"+o+"' id='"+this.responseID+"'/>",r=this.assessmentRef.getNodeByID(this.responseID),r.offsetWidth>this.assessmentRef.getNodeByID("content").offsetWidth&&(r.style.width="95%"),this.putAnswersInPlace(),h=this,c=function(){h.updateAnswers(!0)},this.attachTextListener(r,c)}function QWClozeV1_0(n,t,i){var u,r,f,l,s;for(this.assessmentRef=n,this.respID=t,this.currentOption=null,this.theDiv=this.assessmentRef.getNodeByID("questionstem"+this.respID),this.blanks=0,u=i,this.answer=[],r=0;u["_answer"+r]!=null;)this.answer[r]=u["_answer"+r],r++;this.maxPoints=Number(u._maxScore),this.allowPartialCredit=u._spellingErrorPartialCredit.toLowerCase()=="true",this.caseSensitive=u._caseSensitive.toLowerCase()=="true",this.errorAllowed=Number(u._spellingErrorPercentAllowed),u._isFeedback=="true"?(this.isFeedback=!0,this.originalQuestionID=u._originalquestionid):this.isFeedback=!1;var e=this.theDiv.innerHTML,a=e.length,h="",c=!1,o=0;for(r=0;r<a;r++){if(!c&&e[r]=="_"){o++;continue}o>0&&(this.answer[this.blanks]==null&&(this.answer[this.blanks]=""),h+=this.isFeedback?"<input class='fibinput cloze' type='input' size='"+o+"' id='fib"+this.blanks+this.respID+"' readonly='readonly'/> <span class='correcttextcolor'>("+this.answer[this.blanks].split(";").join(", ").encodeHTML()+")<\/span>":"<input class='fibinput cloze' type='input' size='"+o+"' id='fib"+this.blanks+this.respID+"'/>",o=0,this.blanks++),e[r]=="<"?c=!0:e[r]==">"&&(c=!1),h+=e[r]}for(this.theDiv.innerHTML=h,this.putAnswersInPlace(),r=0;r<this.blanks;r++)f=this.assessmentRef.getNodeByID("fib"+r+this.respID),f.offsetWidth>this.assessmentRef.getNodeByID("content").offsetWidth&&(f.style.width="95%"),this.isFeedback||(l=this,s=function(){l.updateAnswers(!0)},window.addEventListener?(f.addEventListener("input",s,!1),f.addEventListener("blur",s,!1)):(f.attachEvent("onpropertychange",function(){s.call(input)}),f.attachEvent("onblur",function(){s.call(input)})))}function CQSequencingV1_0(n,t,i){var e,h,l;this.assessmentRef=n,this.respID=t,this.myPegBoard=null,this.idTable=[];var f=i,g=Number(f._padding),y=f._slotColor,a=f._slotBorderColor,nt=f._numberTextColor,p="#00FF00";f._answer==null||f._answer==undefined?this.isFeedback=!1:(this.isFeedback=!0,this.correctAnswerArray=f._answer.split(","),this.originalQuestionID=f._originalquestionid);for(var o=0,s=0,c=0,tt=[],v=[],r=this.assessmentRef.getNodeByID(this.respID),u=0,w=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,u=0;u<r.childNodes.length;u++)e=w?document.createElement("span"):document.createElement("a"),h=QWUtils.makeGuid(),e.id=h,this.idTable[r.childNodes[u].id]=h,this.idTable[h]=r.childNodes[u].id,e.className="responselabeldynamic",e.href="#",r.childNodes[u].id="",r.insertBefore(e,r.childNodes[u]),e.appendChild(r.childNodes[u+1]);for(u=0;u<r.childNodes.length;u++)r.childNodes[u].offsetWidth>o&&(o=r.childNodes[u].offsetWidth),r.childNodes[u].offsetHeight>s&&(s=r.childNodes[u].offsetHeight),c++,v.push(r.childNodes[u]);if(l=5,this.myPegBoard=new PegBoard(this,r,5,1,l),this.assessmentRef.getAPIQWObject().getDirection()=="rtl"){var b=o*2+20+l*4+12,k=r.offsetWidth,d=k-b;r.style.left=d+"px"}this.myPegBoard.addColumn(c,o+10,s+10,0,y,a,50,"peg sequence_box",null,!1,!this.isFeedback,!0,!1,!0),this.myPegBoard.addColumn(c,o+10,s+10,12,p,a,this.isFeedback?50:0,this.isFeedback?"peg correct_box":"peg stand_box",v,!this.isFeedback,!this.isFeedback,!1,!0,!1),this.myPegBoard.createSpacerCanvasForDocumentFlow(),this.putAnswersInPlace()}function Branch(n){this.newTarget=n.getAttribute("target"),this.branchDirection=n.getAttribute("direction"),this.theURL=n.getAttribute("forwardURL")}function PegBoard(n,t,i,r,u){document.ondragstart=null,this.theQuestion=n,this.theDiv=t,this.cornerRadius=i,this.lineWidth=r,this.padding=u,this.pegs=[],this.fixedPegs=[],this.answerPegs=[],this.correctAnswerPegs=[],this.draggableSpans=[],this.droppablePegs=[],this.xOffset=0,this.maxWidth=1,this.maxHeight=1,this.columnNumber=0}function Peg(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){var nt,g,tt,it;if(this.divRef=f,this.pegBoard=n,this.xcoord=t,this.ycoord=i,this.id=u,this.colNumber=b,this.pegCanvas=document.createElement("div"),this.pegCanvas.peg=this,this.pegCanvas.style.height=o+"px",this.pegCanvas.style.width=e+"px",this.pegCanvas.id=u,this.pegCanvas.style.position="absolute",this.pegCanvas.className=v,this.pegCanvas.unselectable="on",k&&(this.pegCanvas.innerHTML="<span unselectable='on' style='font-size:"+o+"px;' class='sequencenumber'>"+d+"<\/span>"),f.insertBefore(this.pegCanvas,f.firstChild),nt=this,g=this.pegBoard,w&&(this.pegBoard.droppablePegs.push(this),tt=function(n){n.stopPropagation?n.stopPropagation():n.returnValue=!1,n.preventDefault?n.preventDefault():n.returnValue=!1;var t=XMLMethods.recursiveSearch(nt.divRef,"id",n.dataTransfer.getData("Text"));g.handleDroppedSpan(nt,t,g)},it=function(n){n.stopPropagation?n.stopPropagation():n.returnValue=!1,n.preventDefault?n.preventDefault():n.returnValue=!1},Modernizr.touch,this.pegCanvas.addEventListener?(this.pegCanvas.addEventListener("dragover",it,!1),this.pegCanvas.addEventListener("drop",tt,!1)):(this.pegCanvas.attachEvent("ondragover",it),this.pegCanvas.attachEvent("ondrop",tt))),this.pegCanvas.style.top=i+"px",this.pegCanvas.style.left=t+"px",y!=null&&(this.setSpan(y),this.span.pegBoard=this.pegBoard,p)){this.span.draggable="true",this.pegBoard.draggableSpans.push(this.span);var rt=this.span,ut=function(n){rt.style.opacity=typeof InstallTrigger!="undefined"?0:.3,n.dataTransfer.setData("Text",rt.id)},ft=function(){rt.style.opacity=1},et=null,ot=null,st=function(n){if(n.preventDefault(),n.touches.length==1){var t=n.touches[0].target.parentNode;if(t.id=="spacer")return;if((t.id==null||t.id=="")&&(t=t.parentNode),t.id.length!=36)return;g.setSelectedSpan(t),t.style.opacity=.3,et=n.changedTouches[0].pageX-Number(t.style.left.split("px")[0]),ot=n.changedTouches[0].pageY-Number(t.style.top.split("px")[0])}},ht=function(n){if(n.preventDefault(),n.touches.length==1){var t=n.touches[0].target.parentNode;if((t.id==null||t.id=="")&&(t=t.parentNode),t.id.length!=36)return;t.style.top=n.changedTouches[0].pageY-ot+"px",t.style.left=n.changedTouches[0].pageX-et+"px"}},ct=function(n){var t,i;n.preventDefault(),t=g.getSelectedSpan(),t!=null&&(t.style.opacity=1,i=g.getClosestEmptyPeg(t),g.handleDroppedSpan(i,t,g))};Modernizr.touch&&(this.span.addEventListener("touchstart",st,!1),this.span.addEventListener("touchmove",ht,!1),this.span.addEventListener("touchend",ct,!1)),this.span.addEventListener?(this.span.addEventListener("dragstart",ut,!1),this.span.addEventListener("dragend",ft,!1)):(this.span.attachEvent("ondragstart",ut),this.span.attachEvent("ondragend",ft))}}var qtidoc,matchingCSS,seqCSS;APIQW.prototype.isLoading=function(){return this.loading},APIQW.prototype.isSending=function(){return this.sending},APIQW.prototype.isFinished=function(){return this.finished},APIQW.prototype.isInReport=function(){return this.inReport},APIQW.prototype.areResponsesSent=function(){return this.responsesSent},APIQW.prototype.getScore=function(n){return this.assessRef.getScore("_._."+n)},APIQW.prototype.getElement=function(n){return this.assessRef.getNodeByID(n)},APIQW.prototype.getResponses=function(n){return this.assessRef.getResponsesFromOnlyIdent(n)},APIQW.prototype.getCandidateData=function(n){var t=null;return n==1?t=this.getResponses("Candidate"):n>1&&n<=5&&(t=this.getResponses("CandidateData"+n)),t!=null&&t.length>0?t[0]:""},APIQW.prototype.setResultsURL=function(n){this.assessRef.sendingResults.setResultsURL(n)},APIQW.prototype.setBackupResultsURL=function(n){this.assessRef.sendingResults.setBackupResultsURL(n)},APIQW.prototype.scaleForImageMapCorrection=function(){var n=navigator.userAgent.toLowerCase().indexOf("webkit")>-1;return n&&document.getElementById("thebody").style.zoom!=""?document.getElementById("thebody").style.zoom:1},APIQW.prototype.hideNextButton=function(){var n=this.assessRef.getNodeByID("next");n!=null&&(this.assessRef.getNodeByID("next").style.display="none")},APIQW.prototype.showNextButton=function(){var n=this.assessRef.getNodeByID("next");n!=null&&(this.assessRef.getNodeByID("next").style.display="inline")},APIQW.prototype.setMaxTries=function(n){this.assessRef.sendingResults.setMaxTries(n)},APIQW.prototype.setMaxTriesExceededMessage=function(n){this.assessRef.sendingResults.setMaxTriesExceededMessage(n)},APIQW.prototype.getDirection=function(){return document.getElementById("thebody").style.direction},String.prototype.contains||(String.prototype.contains=function(n){return this.indexOf(n)!=-1}),String.prototype.startsWith||(String.prototype.startsWith=function(n){return this.slice(0,n.length)==n}),String.prototype.endsWith||(String.prototype.endsWith=function(n){return this.slice(-n.length)==n}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.trimChar||(String.prototype.trimChar=function(n){if(this==null||typeof this=="number")return this;for(var t=this;t.startsWith(n);)t=t.slice(n.length,t.length);while(t.endsWith(n))t=t.slice(0,t.length-n.length);return t}),String.prototype.replaceAll||(String.prototype.replaceAll=function(n,t){return this.replace(new RegExp(n,"g"),t)}),String.prototype.encodeHTML||(String.prototype.encodeHTML=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),String.prototype.encodeForXML||(String.prototype.encodeForXML=function(){return this.encodeHTML()}),String.prototype.stripHTML=function(){var n=document.createElement("DIV");return n.innerHTML=this,n.textContent||n.innerText},String.prototype.quizTitle=function(){var n="",t,r;for(i=0;i<this.length;i++)t=this.charCodeAt(i),r=t^123,n=n+String.fromCharCode(r);return n},String.prototype.convertSpecialChars=function(){var e={},n,y,o=[],s="",h="",c=String.fromCharCode,r=[[65,91],[97,123],[48,58],[43,44],[47,48]],i,v;for(z in r)for(n=r[z][0];n<r[z][1];n++)o.push(c(n));for(n=0;n<64;n++)e[o[n]]=n;for(n=0;n<this.length;n+=72)for(var u=0,l,f=0,a=this.substring(n,n+72),t=0;t<a.length;t++)for(l=e[a.charAt(t)],u=(u<<6)+l,f+=6;f>=8;)s+=c((u>>>(f-=8))%256);for(i=s.split(","),i[0]!="assessment()title/"&&(v=".questionarea{background: url(data:image/svg+xml;base64, no-repeat; background-position: center bottom; background-size:90px 96px;}",QWUtils.addCss(v)),n=0;n<i.length;n++)if((window.location+"").contains(i[n]))return h;return Page.prototype.processPresentation=function(){},h},Array.prototype.contains||(Array.prototype.contains=function(n){for(var t=this.length;t--;)if(this[t]===n)return!0;return!1}),Array.prototype.indexOf||(Array.prototype.indexOf=function(n,t){for(var i=t||0,r=this.length;i<r;i++)if(this[i]===n)return i;return-1}),QWUtils={},QWUtils.addWindowResizer=function(n,t){navigator.userAgent.toLowerCase().indexOf("android")==-1&&getStyleQW(document.getElementById("finished"),"padding-bottom")!="122px"&&(window.onresize=function(){var r=QWUtils.getWindowWidth()/n,u=QWUtils.getWindowHeight()/t;r<=u?(document.getElementById("thebody").style.MozTransformOrigin="0 0",document.getElementById("thebody").style.MozTransform="scale("+r+")",document.getElementById("thebody").style.zoom=r):(document.getElementById("thebody").style.MozTransformOrigin="0 0",document.getElementById("thebody").style.MozTransform="scale("+u+")",document.getElementById("thebody").style.zoom=u)},window.onresize())},QWUtils.getWindowWidth=function(){var n=0;return typeof window.innerWidth=="number"?n=window.innerWidth:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?n=document.documentElement.clientWidth:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(n=document.body.clientWidth),n},QWUtils.getWindowHeight=function(){var n=0;return typeof window.innerWidth=="number"?n=window.innerHeight:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?n=document.documentElement.clientHeight:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(n=document.body.clientHeight),n},QWUtils.getParamArrayFromPairs=function(n){var i={},r,t,u;if(n==null)return i;for(r=n.split("&"),t=0;t<r.length;t++)u=r[t].split("="),i[decodeURIComponent(u[0])]=decodeURIComponent(u[1]);return i},QWUtils.S4=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},QWUtils.makeGuid=function(){return QWUtils.S4()+QWUtils.S4()+"-"+QWUtils.S4()+"-"+QWUtils.S4()+"-"+QWUtils.S4()+"-"+QWUtils.S4()+QWUtils.S4()+QWUtils.S4()},QWUtils.escapeFlashVar=function(n){return window.encodeURIComponent?encodeURIComponent(n):escape(n)},QWUtils.imageZoomMouseClick=function(n){n.parentNode.className=n.parentNode.className=="questionimagezoom"?"expandedzoom":"questionimagezoom"},QWUtils.loadScript=function(n,t){var r=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src=n,i.addEventListener?i.addEventListener("load",t,!1):i.readyState&&(i.onreadystatechange=t),r.appendChild(i)},QWUtils.today=new Date,QWUtils.seed=QWUtils.today.getTime(),QWUtils.rnd=function(){return QWUtils.seed=(QWUtils.seed*9301+49297)%233280,QWUtils.seed/233280},QWUtils.rand=function(n){return Math.ceil(QWUtils.rnd()*n)},QWUtils.addCss=function(n){var t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n)),document.getElementsByTagName("head")[0].appendChild(t)},QWUtils.processQuizTitle=function(n){return n.convertSpecialChars()},QWUtils.replaceSpecialURIchars=function(n){return n},XMLMethods={},XMLMethods.makeXMLDoc=function(n){var t;return window.DOMParser?(parser=new DOMParser,t=parser.parseFromString(n,"text/xml")):(t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(n)),t},XMLMethods.makeNode=function(n,t){var i=n.ownerDocument.createElement(t);return n.appendChild(i),i},XMLMethods.makeNodeWithText=function(n,t,i){var r=XMLMethods.makeNode(n,t),u=n.ownerDocument.createTextNode(i);return r.appendChild(u),r},XMLMethods.makeTextNode=function(n,t){var i=n.ownerDocument.createTextNode(t);return n.appendChild(i),i},XMLMethods.addAttribute=function(n,t,i){var r=n.ownerDocument.createAttribute(t);r.nodeValue=i,n.setAttributeNode(r)},XMLMethods.getFirstChildNodeWithName=function(n,t){for(var i=0;i<n.childNodes.length;i++)if(n.childNodes[i].nodeName==t)return n.childNodes[i];return null},XMLMethods.getFirstChildNodeWithNameAndAttribute=function(n,t,i,r){for(var u=0;u<n.childNodes.length;u++)if(n.childNodes[u].nodeName==t&&n.childNodes[u].getAttribute(i)==r)return n.childNodes[u];return null},XMLMethods.setNodeText=function(n,t){n.firstChild.nodeValue=t},XMLMethods.recursiveSearch=function(n,t,i){var r,u;if(n.nodeType!=1)return null;if(n.getAttribute(t)==i)return n;for(r=0;r<n.childNodes.length;r++)if(u=XMLMethods.recursiveSearch(n.childNodes[r],t,i),u!=null)return u;return null},XMLMethods.getFirstChildNodeWithNameAndTextValue=function(n,t,i,r){for(var u=0;u<n.childNodes.length;u++)if(n.childNodes[u].nodeName==t&&n.childNodes[u].firstChild.nodeValue==r)return n.childNodes[u];return null},XMLMethods.getNodeText=function(n){for(var i="",t=0;t<n.childNodes.length;t++)i=i+n.childNodes[t].nodeValue;return i},XMLMethods.getXMLasString=function(n){var t;return t=typeof window.XMLSerializer!="undefined"?(new XMLSerializer).serializeToString(n):n.xml},window.Modernizr=function(n,t,i){function p(n){g.cssText=n}function o(n,t){return typeof n===t}var d="2.8.3",r={},e=t.documentElement,u="modernizr",w=t.createElement(u),g=w.style,nt,tt={}.toString,l=" -webkit- -moz- -o- -ms- ".split(" "),a={svg:"http://www.w3.org/2000/svg"},f={},it={},rt={},b=[],v=b.slice,s,k=function(n,i,r,f){var l,a,c,v,o=t.createElement("div"),h=t.body,s=h||t.createElement("body");if(parseInt(r,10))while(r--)c=t.createElement("div"),c.id=f?f[r]:u+(r+1),o.appendChild(c);return l=["&#173;",'<style id="s',u,'">',n,"<\/style>"].join(""),o.id=u,(h?o:s).innerHTML+=l,s.appendChild(o),h||(s.style.background="",s.style.overflow="hidden",v=e.style.overflow,e.style.overflow="hidden",e.appendChild(s)),a=i(o,n),h?o.parentNode.removeChild(o):(s.parentNode.removeChild(s),e.style.overflow=v),!!a},y={}.hasOwnProperty,h,c;h=!o(y,"undefined")&&!o(y.call,"undefined")?function(n,t){return y.call(n,t)}:function(n,t){return t in n&&o(n.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(n){var t=this,i,r;if(typeof t!="function")throw new TypeError;return i=v.call(arguments,1),r=function(){var f,e,u;return this instanceof r?(f=function(){},f.prototype=t.prototype,e=new f,u=t.apply(e,i.concat(v.call(arguments))),Object(u)===u?u:e):t.apply(n,i.concat(v.call(arguments)))},r}),f.touch=function(){var i;return"ontouchstart"in n||n.DocumentTouch&&t instanceof DocumentTouch?i=!0:k(["@media (",l.join("touch-enabled),("),u,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(n){i=n.offsetTop===9}),i},f.localstorage=function(){try{return localStorage.setItem(u,u),localStorage.removeItem(u),!0}catch(n){return!1}},f.svg=function(){return!!t.createElementNS&&!!t.createElementNS(a.svg,"svg").createSVGRect},f.inlinesvg=function(){var n=t.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==a.svg},f.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(tt.call(t.createElementNS(a.svg,"clipPath")))};for(c in f)h(f,c)&&(s=c.toLowerCase(),r[s]=f[c](),b.push((r[s]?"":"no-")+s));return r.addTest=function(n,t){if(typeof n=="object")for(var u in n)h(n,u)&&r.addTest(u,n[u]);else{if(n=n.toLowerCase(),r[n]!==i)return r;t=typeof t=="function"?t():t,typeof enableClasses!="undefined"&&enableClasses&&(e.className+=" "+(t?"":"no-")+n),r[n]=t}return r},p(""),w=nt=null,r._version=d,r._prefixes=l,r.testStyles=k,r}(this,this.document),QWUtils.useSVG=function(){return Modernizr.svg},QWUtils.displayAVWarning=function(){return location.href.indexOf("file")!=0||QWUtils.useSVG()?"":"<div style='font-size:10px;'>Black box? Oops - you must <a target='_blank' href='http://windows.microsoft.com/en-us/internet-explorer/products/ie/home'>install IE9+<\/a> to preview audio and video from the hard disk. <a target='_blank' href='http://www.questionwriter.com/blog/black-box-error-when-previewing-audio-or-video.html'>Read More<\/a><\/div>"},QWUtils.addAdditionalMediaPlayerSettings=function(n){return n},Preloader.prototype.setLoaderHTML=function(n){this.loaderHTML=n},Preloader.prototype.showLoaderHTML=function(){this.maincontext.getNodeByID("content").innerHTML="",this.maincontext.getNodeByID("loadercontent").innerHTML=this.loaderHTML},Preloader.prototype.hideLoaderHTML=function(){this.maincontext.getNodeByID("loadercontent").innerHTML="",this.maincontext.getNodeByID("loaderprogress").innerHTML="",this.maincontext.getNodeByID("loader").style.display="none",this.maincontext.getNodeByID("assessmentbackground").style.display=""},Preloader.prototype.setFinishHTML=function(n){this.finishHTML=n},Preloader.prototype.setFinishURI=function(n){this.nextURL=n},Preloader.prototype.showFinishHTML=function(){this.maincontext.getNodeByID("assessmentbackground").style.display="none",this.maincontext.getNodeByID("finishedcontent").innerHTML=this.finishHTML,this.maincontext.getNodeByID("finished").style.display="block",this.maincontext.sendingResults.canSend()&&!this.maincontext.getAPIQWObject().areResponsesSent()?this.maincontext.sendingResults.setupResponseSending(this.nextURL):this.nextURL!=null&&this.nextURL!=""&&(window.onbeforeunload=null,window.location=this.nextURL)},Preloader.prototype.setAssessmentReady=function(){this.assessmentready=!0},Preloader.prototype.addImage=function(n){this.imageLocationList.contains(n)||(this.imageLocationList.push(n),newImgNode=document.createElement("img"),newImgNode.src=n,newImgNode.setAttribute("style","display:none"),this.maincontext.getNodeByID("resources").appendChild(newImgNode),this.allImages.push(newImgNode))},Preloader.prototype.updateProgress=function(){for(var t=0,n=0;n<this.allImages.length;n++)this.allImages[n].complete&&t++;t>0,this.assessmentready&&this.numberOfScriptsToLoad<=0&&(!this.waitForLoad||this.allImages.length==t)&&(clearInterval(this.theInterval),this.hideLoaderHTML(),this.maincontext.initializeCurrentPage())},Preloader.prototype.loadScript=function(n){if(!this.scriptLocationList.contains(n)){this.scriptLocationList.push(n),this.numberOfScriptsToLoad++;var t=this;QWUtils.loadScript(n,function(){t.numberOfScriptsToLoad--})}},ResultsSending.prototype.setMaxTries=function(n){this.maxTries=n},ResultsSending.prototype.setMaxTriesExceededMessage=function(n){this.maxTriesExceededMessage=n},ResultsSending.prototype.canSend=function(){return this.sendURL!=null&&this.sendURL!=""||this.altSendURL!=null&&this.altSendURL!=""},ResultsSending.prototype.setResultsURL=function(n){this.sendURL=n},ResultsSending.prototype.setBackupResultsURL=function(n){this.altSendURL=n},ResultsSending.prototype.createContext=function(){var n="<generic_identifier><type_label>",t="<\/type_label><identifier_string>",i="<\/identifier_string><\/generic_identifier>",u="",f="",e="",o="",s="",r="";this.sourceID!=null&&(r=n+"Source ID"+t+this.sourceID+i);var h=n+"System Language"+t+(window.navigator.systemLanguage!=null?window.navigator.systemLanguage:window.navigator.language).encodeForXML()+i,c=n+"OS"+t+(""+window.navigator.platform).encodeForXML()+i,l="",a=n+"Screen Res"+t+(screen.width+"x"+screen.height).encodeForXML()+i,v=n+"Version"+t+window.navigator.userAgent.substring(0,90).encodeForXML()+i,y=n+"Client Time"+t+this.clientTime.encodeForXML()+i,p=n+"Source URL"+t+window.location.href.encodeForXML()+i;return"<context>"+u+f+e+o+s+r+h+c+l+a+v+y+p+"<\/context>"},ResultsSending.prototype.setupResponseSending=function(n){if(this.nextURL=n,this.displayProblem=!1,this.assessRef.getAPIQWObject().sending=!0,this.attempts=0,this.newLineString="<br/>",this.sendingStatus="",this.updateStatus("<font size='+2'>Difficultly Sending Responses:<\/font>"),this.updateStatus("<font size='+2'>Restore Internet Connection To Continue.<\/font>"),this.sendURL==null||this.sendURL=="")return this.sendingStatus="",this.updateStatus("The sendURL variable was empty - there was nowhere to send your responses. There is a problem with the quiz setup. Your responses have not been saved."),this.displayProblem=!0,!1;this.startSend()},ResultsSending.prototype.cleanup=function(){this.assessRef.getAPIQWObject().sending=!1,this.assessRef.getAPIQWObject().responsesSent=!0,this.assessRef.clearDataFromPreviousAttempts(),window.onbeforeunload=null,this.nextURL!=null&&this.nextURL!=""&&(window.location=this.nextURL)},ResultsSending.prototype.resend=function(){var t,n;this.attempts++,this.attempts>=2&&(this.displayProblem=!0),this.updateStatus("----"),this.updateStatus("<font size='+1'>Attempt "+this.attempts+"<\/font>"),t="",n="",n=this.attempts%2==0&&this.altSendURL!=null?this.altSendURL+t:this.sendURL+t;var f=XMLMethods.getXMLasString(this.assessRef.pXMLResults.firstChild),e="<results>"+f+this.createContext()+"<\/results>",i=this,r=function(){i.onLoad()},u=function(){i.timeOut()};this.timeoutID=setTimeout(u,(30+this.delaybetweensends)*1e3),location.protocol==="https:"&&(n=n.replace(/http:/ig,"https:")),location.href.indexOf("file")==0||typeof window.XDomainRequest=="undefined"?(this.xmlHttp=new XMLHttpRequest,this.xmlHttp.onreadystatechange=r,this.updateStatus("Using XML Http Request. Sending results to "+n+" from "+location.href),this.xmlHttp.open("POST",n,!0),this.xmlHttp.setRequestHeader("Content-type","text/plain;charset=UTF-8")):(this.xmlHttp=new XDomainRequest,this.xmlHttp.onload=r,this.updateStatus("Using XDomain Request. Sending results to "+n+" from "+location.href),this.xmlHttp.open("POST",n,!0)),this.xmlHttp.onerror=u,this.xmlHttp.send(e)},ResultsSending.prototype.timeOut=function(){clearInterval(this.timeoutID),this.xmlHttp.onreadystatechange=null,this.xmlHttp.onload=null,this.xmlHttp.onerror=null,this.updateStatus("Timeout"),this.startSend()},ResultsSending.prototype.onLoad=function(){try{var n=this.xmlHttp.responseText,t=this.xmlHttp.readyState}catch(i){return}if(n=="<OK/>")clearTimeout(this.timeoutID),this.updateStatus("Success "),this.xmlHttp.onreadystatechange=null,this.xmlHttp.onload=null,this.xmlHttp.onerror=null,this.cleanup();else if(t==4)this.updateStatus("Finished, but failure"),this.updateStatus("Response: "+n),clearTimeout(this.timeoutID),this.xmlHttp.onreadystatechange=null,this.xmlHttp.onload=null,this.xmlHttp.onerror=null,this.startSend();else return},ResultsSending.prototype.startSend=function(){var n,t,i;if(this.maxTries>0&&this.attempts>=this.maxTries){this.maxTriesExceededMessage!=""&&alert(this.maxTriesExceededMessage),this.cleanup();return}n=this.delaybetweensends-4,t=this,this.updateStatus("Will try to send again in "+n+" seconds. Please restore internet connection."),i=function(){t.resend()},this.resendInterval=setTimeout(i,n*1e3),this.delaybetweensends=(2+this.delaybetweensends)*2},ResultsSending.prototype.updateStatus=function(n){this.sendingStatus=this.sendingStatus+this.newLineString+n,this.displayProblem&&(this.assessRef.getNodeByID("content").innerHTML=this.sendingStatus)},CQSendResultsV1_0.prototype.isFullyAnswered=function(){if(this.assessmentRef.getAPIQWObject().isSending())return!1;clearInterval(this.resultsSendingInterval);var n=this,t=function(){n.assessmentRef.nextButtonAction()};return setTimeout(t,500),!0},CQRandomV1_2.prototype.isFullyAnswered=function(){return this.fullyAnswered},Page.prototype.initializeNextButtons=function(n,t){this.nextButtonCode=n,this.feedbackNextButtonCode="",t.contains("questionpreview")||(this.feedbackNextButtonCode=n),(t.contains("sendresults")||t.contains("questionpreviewnofeedback"))&&(this.nextButtonCode="")},Page.prototype.initializeBackButtons=function(n,t){this.backButtonCode="",(t.contains("endofquiz")||t.contains("nofeedback")||t.contains("endpage"))&&(this.backButtonCode=n),this.feedbackBackButtonCode="",(t.contains("questionpreview")||t.contains("endofquiz")||t.contains("nofeedback"))&&(this.feedbackBackButtonCode=n)},Page.prototype.removeBackButton=function(){this.backButtonCode=""},Page.prototype.getLoader=function(){return this.assessmentRef.getLoader()},Page.prototype.processItemfeedback=function(n){var r=n.getAttribute("ident"),t,i;return this.insideFeedback=!0,t="<div>",i=n.getAttribute("htmlhint"),i!=null&&(t="<div class='"+i+"'>"),t+=this.processDisplayItems(n),t+="<\/div>",this.insideFeedback=!1,t},Page.prototype.processPresentation=function(n){var t="";return t+=this.processDisplayItems(n)},Page.prototype.processResponse_lid=function(n){var t,i;this.responseID=n.getAttribute("ident");var r=this.assessmentRef,u=this.responseID,f=function(){populateMCQuestionWithResponses(r,u)};return this.populateForms.push(f),t="",t+="<span class='activeelement responselid'>",i=XMLMethods.makeNode(this.assessmentRef.getCurrentNode(),"response"),XMLMethods.addAttribute(i,"ident_ref",this.responseID),t+=this.processDisplayItems(n),t+="<\/span>",this.responseID="",t},Page.prototype.processResponse_str=function(n){this.responseID=n.getAttribute("ident");var t="";return t+="<span class='activeelement responsestr'>",t+=this.processDisplayItems(n),t+="<\/span>",this.responseID="",t},Page.prototype.processRender_choice=function(n){var t;this.renderType="mc",t="",t+="<ul class='renderchoice'>",this.minNumber=n.getAttribute("minnumber"),this.maxNumber=n.getAttribute("maxnumber"),t+=this.processDisplayItems(n),t+="<\/ul>";var i=this.assessmentRef,r=this.responseID,u=this.minNumber,f=function(){return MCisFullyAnswered(i,r,u)};return this.fullyAnswered.push(f),this.renderType="",t},Page.prototype.processRender_flash=function(n){var t="",i=n.getAttribute("uri"),e;if(i.endsWith(".swf"))return t+="<div>Old Plugin Question Style Used (.swf type). Flash Plugin Questions are not support. Please upgrade the plugin question to the Javascript type (.js) found in the Question Writer Plugins Folder.<\/div>";!i.contains("CQMatchingV1_1")&&!i.contains("CQSequencingV1_0")&&!i.contains("CQRandomV1_2")&&!i.contains("CQSendResultsV1_0"),this.minNumber=n.getAttribute("minnumber"),this.maxNumber=n.getAttribute("maxnumber");var r=n.getAttribute("symbolname").replaceAll("-",""),o=n.getAttribute("parameters"),s=XMLMethods.makeNode(this.assessmentRef.pCurrentNode,"response");XMLMethods.addAttribute(s,"ident_ref",this.responseID),t+="<div unselectable='on' id='"+this.responseID+"' class='coordinatesystem'>",this.renderType="flash",this.renderFlashLabel=r,t+=this.processDisplayItems(n),this.renderType="",this.renderFlashLabel="";var l=this.assessmentRef.incrementQuestionJSID(),h=this.assessmentRef,c=this.responseID,u=null,f=function(){typeof r!="undefined"&&(u=new window[r](h,c,QWUtils.getParamArrayFromPairs(o)))};return this.insideFeedback?this.populateFeedbacks.push(f):(this.populateForms.push(f),e=function(){return u.isFullyAnswered()},this.fullyAnswered.push(e)),t+="<\/div>"},Page.prototype.processRender_fib=function(n){var t=XMLMethods.makeNode(this.assessmentRef.getCurrentNode(),"response"),e;XMLMethods.addAttribute(t,"ident_ref",this.responseID),XMLMethods.makeNodeWithText(t,"response_value","");var i="",o=n.getAttribute("columns"),s=n.getAttribute("rows");i+="<span id='"+this.responseID+"a'><\/span>";var r="QWFIBV1_0",a=this.assessmentRef.incrementQuestionJSID(),h="_rows="+s+"&_columns="+o,c=this.assessmentRef,l=this.responseID,u=null,f=function(){typeof r!="undefined"&&(u=new window[r](c,l,QWUtils.getParamArrayFromPairs(h)))};return this.insideFeedback?this.populateFeedbacks.push(f):(this.populateForms.push(f),e=function(){return u.isFullyAnswered()},this.fullyAnswered.push(e)),i},Page.prototype.processResponse_label=function(n){return this.renderType=="mc"?this.processResponse_label_mc(n):this.renderType=="flash"?this.processResponse_label_flash(n):""},Page.prototype.processResponse_label_mc=function(n){var t=n.getAttribute("ident"),u="MCbuttonHit("+this.assessmentRef.javascriptID+',"'+this.responseID+'","'+t+'","'+this.minNumber+'","'+this.maxNumber+'",false);',i="radio";this.maxNumber!="1"&&(i="checkbox");var r="<li class='optionandlabel'><span class='buttonlabel'><input onclick='"+u+"' type='"+i+"' class='mc"+i+"' id='"+this.responseID+t+"'/><label id='label"+this.responseID+t+"' onclick='' for='"+this.responseID+t+"'>",f=this.assessmentRef,e=this.responseID;return r+=this.processDisplayItems(n),r+="<\/label><\/span><\/li>"},Page.prototype.processResponse_label_flash=function(n){if(n.getAttribute("skip")=="true")return"";var i=n.getAttribute("ident"),t="<span class='"+this.renderFlashLabel+"' id='"+this.responseID+i+"'>";return t+=this.processDisplayItems(n),t+="<\/span>"},Page.prototype.processDisplayItems=function(n){for(var i="",t=0;t<n.childNodes.length;t++)switch(n.childNodes[t].nodeName){case"flow":i+=this.processFlow(n.childNodes[t]);break;case"material":i+=this.processMaterial(n.childNodes[t]);break;case"response_lid":i+=this.processResponse_lid(n.childNodes[t]);break;case"response_str":i+=this.processResponse_str(n.childNodes[t]);break;case"response_label":i+=this.processResponse_label(n.childNodes[t]);break;case"render_choice":i+=this.processRender_choice(n.childNodes[t]);break;case"render_flash":i+=this.processRender_flash(n.childNodes[t]);break;case"render_fib":i+=this.processRender_fib(n.childNodes[t]);break;case"mattext":i+=this.processMattext(n.childNodes[t]);break;case"matemtext":i+=this.processMatemtext(n.childNodes[t]);break;case"matbreak":i+=this.processMatbreak(n.childNodes[t]);break;case"matimage":i+=this.processMatimage(n.childNodes[t]);break;case"matvar":i+=this.processMatvar(n.childNodes[t]);break;case"matapplication":i+=this.processMatapplication(n.childNodes[t]);break;case"mataudio":i+=this.processMataudio(n.childNodes[t]);break;case"matvideo":i+=this.processMatvideo(n.childNodes[t])}return i},Page.prototype.processFlow=function(n){var r="",t=n.getAttribute("htmlhint"),e,f,o,i,u,s;return t!=null&&!QWUtils.useSVG()&&t.contains("feedback")&&(t=t.replaceAll("correctanswerfeedback","correctanswerfbfallback"),t=t.replaceAll("incorrectanswerfeedback","incorrectanswerfbfallback"),t=t.replaceAll("correctoptionfeedback","correctoptionfbfallback"),t=t.replaceAll("incorrectoptionfeedback","incorrectoptionfbfallback"),t=t.replaceAll("unselectedcorrectoptionfeedback","unselectedcorrectoptionfbfallback"),t=t.replaceAll("unselectedincorrectoptionfeedback","unselectedincorrectoptionfbfallback")),e=n.getAttribute("style"),e!=null&&(r+="<span style='"+e+"'>"),f=n.getAttribute("id"),(t!=null||f!=null)&&(o="",f!=null&&(o=" id='"+f+"'"),i=[],t!=null&&(i=t.split(" ")),r+="<div"+o+" class='"+t+"'>",u=QWUtils.makeGuid(),i.contains("selectedradio")?r+="<span class='buttonlabel'><input checked='checked' disabled='disabled' type='radio' class='mcradio' id='"+u+"'/><label for='"+u+"'>":i.contains("unselectedradio")?r+="<span class='buttonlabel'><input disabled='disabled' type='radio' class='mcradio' id='"+u+"'/><label for='"+u+"'>":i.contains("selectedcheckbox")?r+="<span class='buttonlabel'><input checked='checked' disabled='disabled' type='checkbox' class='mccheckbox' id='"+u+"'/><label for='"+u+"'>":i.contains("unselectedcheckbox")?r+="<span class='buttonlabel'><input disabled='disabled' type='checkbox' class='mccheckbox' id='"+u+"'/><label for='"+u+"'>":i.contains("printout")?r+="<a href='javascript:window.print()'>":i.contains("useremail")&&(s=this.assessmentRef.javascriptID+".sendReportEmail('"+n.getAttribute("email")+"');",r+='<a href="#" onclick="'+s+'">'),i.contains("questioncontainer")&&this.makeQuestionSummary(n)),r+=this.processDisplayItems(n),(t!=null||f!=null)&&(i.contains("selectedradio")||i.contains("unselectedradio")||i.contains("selectedcheckbox")||i.contains("unselectedcheckbox")?r+="<\/label><\/span>":(i.contains("printout")||i.contains("useremail"))&&(r+="<\/a>"),r+="<\/div>"),e!=null&&(r+="<\/span>"),r},Page.prototype.processMaterial=function(n){return this.processFlow(n)},Page.prototype.summaryMattext=function(n){return XMLMethods.getNodeText(n).replace(/&nbsp;/g," ").replaceAll("ZyXnewlineXyZ","\n")},Page.prototype.processMattext=function(n){var t="",r=n.getAttribute("texttype"),u,f,i;return r=="text/javascript"&&n.childNodes.length>0?(u=n.childNodes[0].nodeValue.replaceAll("ZyXnewlineXyZ","\n"),f=this.assessmentRef.javascriptID,this.populateContent.push(function(){eval("var QWAPI="+f+".getAPIQWObject();\n"+u)}),""):(r=="text/mathml"&&n.childNodes.length>0&&(this.processMathjax||(this.populateContent.push(function(){eval("MathJax.Hub.Queue(['Typeset', MathJax.Hub]);\n")}),this.processMathjax=!0)),i=n.getAttribute("htmlhint"),i!=null&&(t+="<span class='"+i+"'>"),t+=this.summaryMattext(n),i!=null&&(t+="<\/span>"),t)},Page.prototype.summaryMatemtext=function(n){return XMLMethods.getNodeText(n).replace(/&nbsp;/g," ")},Page.prototype.processMatemtext=function(n){return"<span class='matemtext'>"+this.summaryMatemtext(n)+"<\/span>"},Page.prototype.processMatvar=function(n){var t=QWUtils.makeGuid(),i=n.getAttribute("varname"),r=n.getAttribute("respident");return i!=null?(this.thePopulateMatvars[t]=i,"<span class='matvar' id='"+t+"'><\/span>"):r!=null?(this.thePopulateMatvars[t]="respident."+r,"<span class='matvar' id='"+t+"'><\/span>"):""},Page.prototype.processMatbreak=function(){return"<br/>"},Page.prototype.processMataudio=function(n){var l=n.getAttribute("uri"),f="audio"+QWUtils.makeGuid().replaceAll("-",""),t={},r=n.getAttribute("width"),i,e,u,o,s,h,c;return r!=null&&(t.audioWidth=r),i=n.getAttribute("height"),i!=null&&(t.audioHeight=i),e=n.getAttribute("autostart"),u="",e=="true"&&(u=" autoplay = 'true'"),o=n.getAttribute("nativeandroid"),o=="true"&&(t.AndroidUseNativeControls=!0),s=n.getAttribute("nativeipad"),s=="true"&&(t.iPadUseNativeControls=!0),h=n.getAttribute("nativeiphone"),h=="true"&&(t.iPhoneUseNativeControls=!0),t=QWUtils.addAdditionalMediaPlayerSettings(t),c=function(){$("#"+f).mediaelementplayer(t)},this.populateContent.push(c),"<audio width='"+r+"' height='"+i+"' id='"+f+"' src='"+QWUtils.replaceSpecialURIchars(l)+"'"+u+"><\/audio>"+QWUtils.displayAVWarning()},Page.prototype.processMatvideo=function(n){var l=n.getAttribute("uri"),f="video"+QWUtils.makeGuid().replaceAll("-",""),t={},r=n.getAttribute("width"),i,e,u,o,s,h,c;return r!=null&&(t.videoWidth=r),i=n.getAttribute("height"),i!=null&&(t.videoHeight=i),e=n.getAttribute("autostart"),u="",e=="true"&&(u=" autoplay = 'true'"),o=n.getAttribute("nativeandroid"),o=="true"&&(t.AndroidUseNativeControls=!0),s=n.getAttribute("nativeipad"),s=="true"&&(t.iPadUseNativeControls=!0),h=n.getAttribute("nativeiphone"),h=="true"&&(t.iPhoneUseNativeControls=!0),t=QWUtils.addAdditionalMediaPlayerSettings(t),c=function(){$("#"+f).mediaelementplayer(t)},this.populateContent.push(c),"<video width='"+r+"' height='"+i+"' id='"+f+"' src='"+QWUtils.replaceSpecialURIchars(l)+"'"+u+"><\/video>"+QWUtils.displayAVWarning()},Page.prototype.summaryMataudio=function(n){return"Audio:"+n.getAttribute("uri")},Page.prototype.processMatapplication=function(n){var i=n.getAttribute("width"),r=n.getAttribute("height"),u=n.getAttribute("uri"),t=n.getAttribute("alignment"),e,y,p,o,s,h,f,w,c,l,a,v;if((t==""||t==null)&&(t="left"),e=n.getAttribute("htmlhint"),u.toLowerCase().endsWith(".swf")){i==null&&(i="100%"),r==null&&(r="100%"),y={wmode:"opaque"},o=QWUtils.makeGuid(),p="<div style='text-align:"+t+";' id='"+o+"'>Flash SWF("+u+")<\/div>",s=QWUtils.getParamArrayFromPairs(n.getAttribute("parameters")),h=[];for(f in s)f!=""&&(h[f]=QWUtils.escapeFlashVar(s[f]));return w=function(){swfobject.embedSWF("resfiles/"+QWUtils.replaceSpecialURIchars(u),o,i,r,"8.0.0","http://www.questionwritertracker.com/common/expressInstall.swf",h,y)},this.populateContent.push(w),p}return c="",l="",i!=null?c=" width='"+i+"'":l=" imagemaxwidth",a="",r!=null&&(a=" height='"+r+"'"),t=t.toLowerCase(),v=t=="left"?"":""+t=="right"?"imagerightalign":""+t=="center"?"imagecenteralign":"",e!==null&&e.contains("imagecontrol")?"<img class='imagecontrol "+v+"' border='0' onclick='javascript:QWUtils.imageZoomMouseClick(this);' src='resfiles/"+QWUtils.replaceSpecialURIchars(u)+"'/><br clear='all'/>":"<img class='regularimage "+v+l+"' "+c+a+" border='0' src='resfiles/"+QWUtils.replaceSpecialURIchars(u)+"'/>"},Page.prototype.summaryMatapplication=function(n){return"App:"+n.getAttribute("uri")},Page.prototype.processMatimage=function(n){return this.processMatapplication(n)},Page.prototype.summaryMatimage=function(n){return"Image:"+n.getAttribute("uri")},Page.prototype.makeQuestionSummary=function(n){var t=XMLMethods.makeNode(this.assessmentRef.getCurrentNode(),"summary"),f;this.extractOptionsSummary(n,t);for(var r=[],u=t.childNodes.length,i=0,i=0;i<u;i++)r.push(t.removeChild(t.childNodes[0]));for(r.sort(function(n,t){var i=n.getAttribute("ident").toLowerCase(),r=t.getAttribute("ident").toLowerCase();return i<r?-1:i>r?1:0}),i=0;i<u;i++)t.appendChild(r.shift(0));f=XMLMethods.makeNodeWithText(t,"stem",this.extractSummaryText(n).trim()),t.insertBefore(f,t.firstChild)},Page.prototype.extractOptionsSummary=function(n,t){for(var r,i=0;i<n.childNodes.length;i++)switch(n.childNodes[i].nodeName){case"response_label":r=XMLMethods.makeNodeWithText(t,"option",this.extractSummaryText(n.childNodes[i]).trim()),XMLMethods.addAttribute(r,"ident",n.childNodes[i].getAttribute("ident"));break;case"response_lid":XMLMethods.addAttribute(t,"ident",n.childNodes[i].getAttribute("ident")),XMLMethods.addAttribute(t,"type",n.childNodes[i].getAttribute("type"));case"response_str":XMLMethods.addAttribute(t,"ident",n.childNodes[i].getAttribute("ident")),XMLMethods.addAttribute(t,"type",n.childNodes[i].getAttribute("type"));default:this.extractOptionsSummary(n.childNodes[i],t)}},Page.prototype.extractSummaryText=function(n){for(var i="",t=0;t<n.childNodes.length;t++)switch(n.childNodes[t].nodeName){case"flow":i+=this.extractSummaryText(n.childNodes[t]);break;case"material":i+=this.extractSummaryText(n.childNodes[t]);break;case"mattext":i+=this.summaryMattext(n.childNodes[t]).encodeForXML()+" ";break;case"matemtext":i+=this.summaryMatemtext(n.childNodes[t]).encodeForXML()+" ";break;case"matbreak":i+=" ";break;case"matimage":i+=this.summaryMatimage(n.childNodes[t]).encodeForXML()+" ";break;case"matapplication":i+=this.summaryMatapplication(n.childNodes[t]).encodeForXML()+" ";break;case"mataudio":i+=this.summaryMataudio(n.childNodes[t]).encodeForXML()+" ";break;case"response_lid":case"response_str":case"response_label":this.responseID=n.childNodes[t].getAttribute("ident")}return i},Page.prototype.evalArrayOfJS=function(n){for(var t=0;t<n.length;t++)typeof n[t]=="function"?n[t]():alert("Not a function - update "+n[t]);return},Page.prototype.isFullyAnswered=function(){for(var n=0;n<this.fullyAnswered.length;n++)if(!this.fullyAnswered[n]())return!1;return!0},Page.prototype.getPresentationHTML=function(){return this.presentationHTML},Page.prototype.getBackButtonCode=function(){return this.backButtonCode},Page.prototype.getNextButtonCode=function(){return this.nextButtonCode},Page.prototype.getFeedbackBackButtonCode=function(){return this.feedbackBackButtonCode},Page.prototype.getFeedbackNextButtonCode=function(){return this.feedbackNextButtonCode},Page.prototype.getResponseProcessingNode=function(){return this.responseProcessingNode},Page.prototype.getItemFeedbacks=function(){return this.itemFeedbacks},Page.prototype.getPopulateMatvars=function(){return this.thePopulateMatvars},Page.prototype.getPopulateForms=function(){return this.populateForms},Page.prototype.getPopulateFeedbacks=function(){return this.populateFeedbacks},Page.prototype.displayPresentation=function(){if(this.presentationHTML!=""&&this.presentationHTML!=null){try{(this.presentationHTML==undefined||this.presentationHTML=="undefined")&&(this.presentationHTML=""),this.assessmentRef.getNodeByID("content").innerHTML=this.presentationHTML,this.assessmentRef.getNodeByID("content").scrollTop=0,this.assessmentRef.getNodeByID("backbutton").innerHTML=this.backButtonCode,this.assessmentRef.getNodeByID("nextbutton").innerHTML=this.nextButtonCode;var n=this.assessmentRef.getNodeByID("back"),t=this.assessmentRef.getNodeByID("next")}catch(i){return alert("An Error Occurred While Displaying Page: \n"+i.message+"\n"+i.stack),!1}try{this.evalArrayOfJS(this.populateContent),this.evalArrayOfJS(this.populateForms)}catch(i){alert("An Error Occurred While Populating Page: "+i.message+"\n"+i.stack)}return!0}return!1},Page.prototype.displayFeedback=function(){var n="";try{n=this.evaluateRPS()}catch(t){return alert("An Error Occurred While Evaluating Response Processing: "+t.message+"\n"+t.stack),!1}if(n!=""){try{this.assessmentRef.getNodeByID("content").innerHTML='<div class="questionfeedbackoverview">'+n+"<\/div>",this.assessmentRef.getNodeByID("content").scrollTop=0,this.assessmentRef.getNodeByID("backbutton").innerHTML=this.feedbackBackButtonCode,this.assessmentRef.getNodeByID("nextbutton").innerHTML=this.feedbackNextButtonCode}catch(t){return alert("An Error Occurred While Displaying Feedback: "+t.message+"\n"+t.stack),!1}try{this.evalArrayOfJS(this.populateContent),this.evalArrayOfJS(this.populateFeedbacks)}catch(t){alert("An Error Occurred While Populating Feedback Content: "+t.message+"\n"+t.stack)}return!0}return!1},Page.prototype.evaluateRPS=function(){var t,i,n;if(this.ident=="CalculationPage"&&(this.assessmentRef.testEndTime=(new Date).toLocaleString()),this.responseProcessingNode==null)return"";this.feedbackDisplay=[],this.rp=new ResponseProcessing(this.responseProcessingNode,this.assessmentRef.pCurrentNode,this.assessmentRef),this.feedbackDisplay=this.feedbackDisplay.concat(this.rp.getFeedbackDisplay()),t="";for(i in this.itemFeedbacks)for(n=0;n<this.feedbackDisplay.length;n++)this.feedbackDisplay[n]==i&&(t=t+this.itemFeedbacks[this.feedbackDisplay[n]]);return t},qtidoc="",Assessment.prototype.clearDataFromPreviousAttempts=function(){this.copyResultsToLocalStorageIntervalHandle!=null&&clearInterval(this.copyResultsToLocalStorageIntervalHandle),Modernizr.localstorage&&(localStorage.setItem(this.assessmentGUID,null),localStorage.setItem(this.contentGUID,null))},Assessment.prototype.loadAssessmentContent=function(n,t,i){var u;this.pXMLResults=XMLMethods.makeXMLDoc("<result><\/result>"),this.pCurrentNode=this.pXMLResults.firstChild,u=null,n&&Modernizr.localstorage&&(u=localStorage.getItem(this.assessmentGUID)),(u==null||u=="null")&&(u=""+QWUtils.rand(t),Modernizr.localstorage&&localStorage.setItem(this.assessmentGUID,u));var r=this,f=!1,e=function(){if(qtidoc==""){setTimeout(e,500);return}if(!f){if(f=!0,r.processAssessment(XMLMethods.makeXMLDoc(qtidoc)),n){var t=null;Modernizr.localstorage&&(t=localStorage.getItem(r.contentGUID)),t!=null&&t!="null"&&(r.pXMLResults=XMLMethods.makeXMLDoc(t),r.pCurrentNode=r.pXMLResults.firstChild),r.copyResultsToLocalStorageIntervalHandle=setInterval(function(){r.copyResultsToLocalStorage()},1e4)}r.loader.setAssessmentReady(r)}};QWUtils.loadScript(i+u+".js",e)},Assessment.prototype.copyResultsToLocalStorage=function(){Modernizr.localstorage&&localStorage.setItem(this.contentGUID,XMLMethods.getXMLasString(this.pXMLResults))},Assessment.prototype.processAssessment=function(n){for(var t=n.firstChild,r,i;t.nodeName!="assessment";)t=t.nextSibling;for(this.contentGUID=t.getAttribute("guid"),this.nextButtonText=t.getAttribute("nextbuttontext"),this.backButtonText=t.getAttribute("backbuttontext"),this.restartButtonText=t.getAttribute("restartbuttontext"),this.areYouSure=t.getAttribute("restartsuretext"),this.restartButtonText!=null&&this.restartButtonText!=""&&(r="<button class='restartbutton restartbuttonbackground"+(QWUtils.useSVG()?"svg":"")+"' onclick='"+this.javascriptID+".restartButtonClicked();' title='restart' id='restart' name='restart' type='button' value='restart'>"+this.restartButtonText.encodeHTML()+"<\/button>",this.getNodeByID("restartbutton").innerHTML=r),QWUtils.processQuizTitle(t.getAttribute("quiztitle")),this.pCurrentNode=XMLMethods.makeNode(this.pCurrentNode,"assessment_result"),XMLMethods.addAttribute(this.pCurrentNode,"ident_ref",t.getAttribute("ident")),XMLMethods.addAttribute(this.pCurrentNode,"qwappversion",t.getAttribute("qwappversion")),i=0;i<t.childNodes.length;i++)switch(t.childNodes[i].nodeName){case"section":this.processSection(t.childNodes[i]);break;case"assessfeedback":this.processAssessfeedback(t.childNodes[i]);break;case"rubric":this.processRubric(t.childNodes[i]);break;case"duration":this.processDuration(t.childNodes[i])}this.pCurrentNode=this.pCurrentNode.parentNode},Assessment.prototype.processSection=function(n){var t,i;for(this.pCurrentNode=XMLMethods.makeNode(this.pCurrentNode,"section_result"),XMLMethods.addAttribute(this.pCurrentNode,"ident_ref",n.getAttribute("ident")),t=0;t<n.childNodes.length;t++)switch(n.childNodes[t].nodeName){case"section":this.processSection(n.childNodes[t]);break;case"item":i=n.childNodes[t].getAttribute("ident"),this.pCurrentNode=XMLMethods.makeNode(this.pCurrentNode,"item_result"),XMLMethods.addAttribute(this.pCurrentNode,"ident_ref",i),this.pages[i]=new Page(n.childNodes[t],this,this.pCurrentNode,this.nextButtonText,this.backButtonText),this.pCurrentNode=this.pCurrentNode.parentNode;for(aPage in this.pages){this.pages[aPage].removeBackButton();break}break;case"duration":this.processDuration(n.childNodes[t])}this.pCurrentNode=this.pCurrentNode.parentNode},Assessment.prototype.processAssessfeedback=function(n){var t=this.processFlow(n);return n.getAttribute("ident")=="loader"?(this.loader.setLoaderHTML(t),this.loader.showLoaderHTML()):n.getAttribute("ident")=="finished"&&(this.loader.setFinishHTML(t),this.nextURL!=""?this.loader.setFinishURI(this.nextURL):this.loader.setFinishURI(n.getAttribute("uri"))),""},Assessment.prototype.processRubric=function(n){this.assessmentRubric=this.processFlow(n)},Assessment.prototype.processDuration=function(n){XMLMethods.addAttribute(this.pCurrentNode,"timelimit",n.firstChild.nodeValue.replace("P","").replace("T","").replace("S",""))},Assessment.prototype.processMaterial=Page.prototype.processMaterial,Assessment.prototype.processDisplayItems=Page.prototype.processDisplayItems,Assessment.prototype.processFlow=Page.prototype.processFlow,Assessment.prototype.processMaterial=Page.prototype.processMaterial,Assessment.prototype.processMattext=Page.prototype.processMattext,Assessment.prototype.summaryMattext=Page.prototype.summaryMattext,Assessment.prototype.processMatemtext=Page.prototype.processMatemtext,Assessment.prototype.summaryMatemtext=Page.prototype.summaryMatemtext,Assessment.prototype.processMatvar=Page.prototype.processMatvar,Assessment.prototype.processMatbreak=Page.prototype.processMatbreak,Assessment.prototype.processMatapplication=Page.prototype.processMatapplication,Assessment.prototype.processMatimage=Page.prototype.processMatimage,Assessment.prototype.getLoader=function(){return this.loader},Assessment.prototype.setForwardURL=function(n){this.loader.setFinishURI(n)},Assessment.prototype.getCurrentNode=function(){return this.pCurrentNode},Assessment.prototype.getNodeByID=function(n){return XMLMethods.recursiveSearch(this.assessmentDiv,"id",n)},Assessment.prototype.incrementQuestionJSID=function(){return this.questionJSID++},Assessment.prototype.getCurrentPage=function(){return this.pages[this.pCurrentNode.getAttribute("ident_ref")]},Assessment.prototype.setSeekBranch=function(n,t){this.seekBranchTarget=n,this.branchOriginNode=this.pCurrentNode,t=="back"&&(this.branchBackwards=!0)},Assessment.prototype.initializeCurrentPage=function(){while(this.pCurrentNode.nodeName!="item_result"&&this.pCurrentNode.firstChild!=null)this.enterNode(this.pCurrentNode.firstChild);this.pCurrentNode.nodeName=="item_result"&&this.displayCurrentPage()},Assessment.prototype.displayCurrentPage=function(){for(var n,t,i,r,u,f;this.pCurrentNode.nodeName!="item_result";)this.enterNode(this.getNextValidNode(this.pCurrentNode.firstChild,null));if(n=!0,t=this.getCurrentPage(),n=this.inFeedback?t.displayFeedback():t.displayPresentation(),!n){if(this.navForwardDirection){this.nextButtonAction();return}this.backButtonAction();return}i=t.getPopulateMatvars();for(r in i)u=this.getNodeByID(r),u!=null&&(f=document.createTextNode(this.getMatvar(i[r],0)),u.appendChild(f));this.timerManager.checkTimers(),this.processFullyAnswered()},Assessment.prototype.restartButtonClicked=function(){confirm(this.areYouSure)&&(this.clearDataFromPreviousAttempts(),window.location.reload(!0))},Assessment.prototype.nextButtonClicked=function(){this.nextButtonAction()},Assessment.prototype.nextButtonAction=function(){var i,n,t;if(this.navForwardDirection=!0,this.inFeedback)this.inFeedback=!1;else{this.inFeedback=!0,this.displayCurrentPage();return}if(this.branchBackwards){this.clickedNextButIsBeingBranchedBackwards=!0,this.backButtonAction();return}if(i=this.pCurrentNode,this.exitNode(),n=this.getNextValidNode(this.pCurrentNode,i),n.nodeName=="result"){this.clearDataFromPreviousAttempts(),window.onbeforeunload=null,this.theSCORMCOMM&&(t=[],t.push("LMSFinish"),this.theSCORMCOMM.queueFS(t),this.theSCORMCOMM.clearQueue()),this.loader.showFinishHTML();return}this.enterNode(n),this.displayCurrentPage()},Assessment.prototype.getNextValidNode=function(n,t){var i,r;if(n.nodeName=="result")return n;do{if(t==null){if(t=n.firstChild,t==null)return null}else if(t=t.nextSibling,t==null)break;if(t.nodeName=="section_result"||t.nodeName=="assessment_result"){if(this.enterNode(t),i=this.getNextValidNode(t,null),i!=null)return i;this.exitNode()}if(t.nodeName=="item_result"){if(this.seekBranchTarget==null)return t;if(this.seekBranchTarget==t.getAttribute("ident_ref"))return XMLMethods.addAttribute(t,"previouspageid",this.branchOriginNode.getAttribute("ident_ref")),this.seekBranchTarget=null,this.branchOriginNode=null,t}}while(t.nextSibling!=null);return r=n,this.exitNode(),this.getNextValidNode(this.pCurrentNode,r)},Assessment.prototype.backButtonClicked=function(){this.backButtonAction()},Assessment.prototype.backButtonAction=function(){var n,t;if(this.navForwardDirection=!1,this.inFeedback){this.inFeedback=!1,this.displayCurrentPage();return}this.getCurrentPage().evaluateRPS(),this.inFeedback=!0,this.clickedNextButIsBeingBranchedBackwards||(this.seekBranchTarget=this.pCurrentNode.getAttribute("previouspageid")),n=this.pCurrentNode,this.exitNode(),t=this.getPreviousValidNode(this.pCurrentNode,n),this.enterNode(t),this.displayCurrentPage()},Assessment.prototype.getPreviousValidNode=function(n,t){var i,r;do{if(t==null){if(t=n.lastChild,t==null)return null}else if(t=t.previousSibling,t==null)break;if(t.nodeName=="section_result"||t.nodeName=="assessment_result"){if(this.enterNode(t),i=this.getPreviousValidNode(t,null),i!=null)return i;this.exitNode()}if(t.nodeName=="item_result"){if(this.seekBranchTarget==null)return t;if(this.seekBranchTarget==t.getAttribute("ident_ref"))return this.seekBranchTarget=null,this.branchOriginNode=null,this.clickedNextButIsBeingBranchedBackwards=!1,this.branchBackwards=!1,t}}while(t.previousSibling!=null);return r=n,this.exitNode(),this.getPreviousValidNode(this.pCurrentNode,r)},Assessment.prototype.enterNode=function(n){n.nodeName=="assessment_result"&&(this.getNodeByID("assessmentrubric").innerHTML=this.assessmentRubric),this.pCurrentNode=n,this.timerManager.startTimer(this.pCurrentNode)},Assessment.prototype.exitNode=function(){this.timerManager.stopTimer(),this.pCurrentNode=this.pCurrentNode.parentNode,this.pCurrentNode.nodeName=="result"&&(this.getNodeByID("content").innerHTML="",this.getNodeByID("backbutton").innerHTML="",this.getNodeByID("nextbutton").innerHTML="",this.getNodeByID("assessmentrubric").innerHTML="")},Assessment.prototype.setNextButtonVisible=function(n){this.getNodeByID("nextbutton").style.visibility=n?"visible":"hidden"},Assessment.prototype.processFullyAnswered=function(){var n=this.pages[this.pCurrentNode.getAttribute("ident_ref")];if(n.isFullyAnswered()){if(this.pCurrentNode.getAttribute("autoforward")=="true"&&this.navForwardDirection==!0){this.nextButtonAction();return}this.setNextButtonVisible(!0)}else this.pCurrentNode.getAttribute("allowUnansweredForward")=="false"&&this.setNextButtonVisible(!1)},Assessment.prototype.sendResults=function(){this.sendingResults.setupResponseSending(null)},Assessment.prototype.setAnswers=function(n,t,i,r){for(var f=XMLMethods.getFirstChildNodeWithNameAndAttribute(this.pCurrentNode,"response","ident_ref",n),u=f.childNodes.length-1;u>-1;u--)f.childNodes[u].nodeName=="response_value"&&f.removeChild(f.childNodes[u]);for(u=0;u<t.length;u++)XMLMethods.makeNodeWithText(f,"response_value",t[u]);r!=null&&f.setAttribute("score",r),i!=!1&&this.processFullyAnswered()},Assessment.prototype.getAnswers=function(n){for(var i=XMLMethods.getFirstChildNodeWithNameAndAttribute(this.pCurrentNode,"response","ident_ref",n),r=[],t=0;t<i.childNodes.length;t++)i.childNodes[t].nodeName=="response_value"&&(i.childNodes[t].firstChild==null&&XMLMethods.makeTextNode(i.childNodes[t],""),r.push(i.childNodes[t].firstChild.nodeValue));return r},Assessment.prototype.getRespList=function(n){for(var i=n.split("."),r,t=i.length==1?this.pCurrentNode:this.pXMLResults.firstChild,u=0;u<i.length;u++)for(r=0;r<t.childNodes.length;r++)if(t.childNodes[r].getAttribute("ident_ref")==i[u]){t=t.childNodes[r];break}return t.getAttribute("ident_ref")==i[i.length-1]?t:(alert("Failed to find Responses for "+n),null)},Assessment.prototype.getScoreAttribute=function(n){var t=this.getRespList(n);return t.getAttribute("score")},Assessment.prototype.getRespListAsArray=function(n){var r,i,u,t;if(n=="CQDATETIME")return r=[],r.push(this.testEndTime),r;for(i=this.getRespList(n),u=[],t=0;t<i.childNodes.length;t++)i.childNodes[t].nodeName=="response_value"&&u.push(i.childNodes[t].firstChild.nodeValue);return u},Assessment.prototype.getResponsesFromOnlyIdent=function(n){var i=XMLMethods.recursiveSearch(this.pXMLResults.firstChild,"ident_ref",n),r,t;if(i==null)return null;for(r=[],t=0;t<i.childNodes.length;t++)i.childNodes[t].nodeName=="response_value"&&r.push(i.childNodes[t].firstChild.nodeValue);return r},Assessment.prototype.getScore=function(n){var t=n.split("."),i=t[t.length-1];return this.getSectionItemScore(this.getTargetNode(n),i)},Assessment.prototype.getDuration=function(n){var t=n.split("."),i=t[t.length-1];return Number(this.getTargetNode(n).getAttribute("timeelapsed"))},Assessment.prototype.getTargetNode=function(n){for(var u=n.split("."),t=null,i,t=u.length==1?this.pCurrentNode:this.pXMLResults.firstChild,r=0;r<u.length-1;r++)for(i=0;i<t.childNodes.length;i++){if(t.childNodes[i].getAttribute("ident_ref")==u[r]){t=t.childNodes[i];break}i==t.childNodes.length-1&&(r=u.length-1)}return t},Assessment.prototype.getSectionItemScore=function(n,t){var i=0,f,r,e,u,o;if(n.nodeName=="item_result"){for(i=0;i<n.childNodes.length;i++)if(n.childNodes[i].nodeName=="outcomes"){for(f=n.childNodes[i],r=0;r<f.childNodes.length;r++)if(e=f.childNodes[r].getAttribute("varname").toLowerCase(),f.childNodes[r].nodeName=="score"&&e!=null&&t!=null&&e==t.toLowerCase())return f.childNodes[r].firstChild.nodeValue;return 0}return 0}for(u=n.childNodes,o=0,i=0;i<u.length;i++)(u[i].nodeName=="item_result"||u[i].nodeName=="section_result"||u[i].nodeName=="assessment_result")&&(o+=Number(this.getSectionItemScore(u[i],t)));return o},Assessment.prototype.getMatvar=function(n,t){return n.startsWith("respident.")?(t==null&&(t=0),this.getRespListAsArray(n.slice("respident.".length,n.length))[t]):this.getScore(n)},Assessment.prototype.getAPIQWObject=function(){return this.theAPI},Assessment.prototype.getCurrentNode=function(){return this.pCurrentNode},Assessment.prototype.getCurrentIdent=function(){return this.pCurrentNode.getAttribute("ident_ref")},Assessment.prototype.getSCORMComms=function(){return this.theSCORMCOMM},Assessment.prototype.getPageIDForSCORM=function(n){var t=this.pCurrentNode.getAttribute("scormpageid");return t==null&&(t=this.SCORMPageID,this.pCurrentNode.setAttribute("scormpageid",t),this.SCORMPageID=this.SCORMPageID+n),t},Assessment.prototype.sendReportEmail=function(n){return window.open("mailto:?to="+n+"&subject=Quiz%20Results&body="+encodeURIComponent(XMLMethods.getXMLasString(XMLMethods.recursiveSearch(this.assessmentDiv,"class","reportheader")).stripHTML()+"\n"+XMLMethods.getXMLasString(XMLMethods.recursiveSearch(this.assessmentDiv,"class","yourscores")).stripHTML()+"\n"+XMLMethods.getXMLasString(XMLMethods.recursiveSearch(this.assessmentDiv,"class","scoredata")).stripHTML())),!1},QWTimerManager.prototype.startTimer=function(n){var t=new QWTimer(n);this.activeTimers.push(t)},QWTimerManager.prototype.stopTimer=function(){var n=this.activeTimers.pop();n.commitTime(),this.timerDisplay!=null&&(this.timerDisplay.innerHTML="")},QWTimerManager.prototype.checkTimers=function(){for(var t,n=0;n<this.activeTimers.length;n++)t=this.activeTimers[n].updateTimer(),t>0?(this.timerDisplay==null&&(this.timerDisplay=this.assessref.getNodeByID("timer")),this.timerDisplay.innerHTML=this.formatTime(t)):t<0&&(this.timerDisplay.innerHTML="",this.assessref.nextButtonAction())},QWTimerManager.prototype.formatTime=function(n){var r,t,i;return n/=1e3,n<0?"00:00:00":(r=""+Math.floor(n/3600),t=""+Math.floor(Math.floor(n/60))%60,t.length<2&&(t="0"+t),i=""+Math.floor(n)%60,i.length<2&&(i="0"+i),""+r+":"+t+":"+i)},QWTimer.prototype.updateTimer=function(){var n=Number(this.targetXMLNode.getAttribute("timeelapsed")),t=+new Date,i=t-Number(this.targetXMLNode.getAttribute("starttime"));return n+=i,this.targetXMLNode.setAttribute("timeelapsed",""+n),this.targetXMLNode.setAttribute("starttime",""+t),this.timelimit!=null?this.timelimit*1e3-n:0},QWTimer.prototype.commitTime=function(){var i=this.targetXMLNode.getAttribute("timeelapsed"),t="P"+i/1e3+"S",n=XMLMethods.getFirstChildNodeWithName(this.targetXMLNode,"duration");n==null?n=XMLMethods.makeNodeWithText(this.targetXMLNode,"duration",t):n.firstChild.nodeValue=t},QWTimer.prototype.timerDebugInfo=function(){return(new XMLSerializer).serializeToString(this.targetXMLNode)},Decvar.prototype.ensureValueExists=function(){this.name==null&&(this.name="score"),this.vartype==null&&(this.vartype="Integer"),this.value==null&&(this.vartype=="String"?this.value="":this.vartype=="Decimal"||this.vartype=="Scientific"||this.vartype=="Number"?this.value=0:this.vartype=="Boolean"?this.value=!1:this.vartype=="Enumerated"?this.value=this.members.length>=1?this.members[i]:"":(this.value=0,this.vartype="Integer")),XMLMethods.setNodeText(this.resultsDocNode,this.value)},Decvar.prototype.getName=function(){return this.name},Decvar.prototype.setVarOp=function(n,t){this.vartype=="Integer"||this.vartype=="Scientific"||this.vartype=="Decimal"||this.vartype=="Number"?(isNaN(Number(n))&&(n=0),t=="Add"?this.setValue(Number(this.value)+Number(n)):t=="Subtract"?this.setValue(Number(this.value)-Number(n)):t=="Multiply"?this.setValue(Number(this.value)*Number(n)):t=="Divide"&&(Number(n==0)?this.setValue(0):this.setValue(Number(this.value)/Number(n)))):this.vartype=="Boolean"?(this.tempBool=n=="true"||n=="True"||n=="TRUE"||n==!0?!0:!1,t=="Add"?this.setValue((this.value+tempBool)%2):t=="Subtract"?this.setValue((this.value-tempBool)%2):t=="Multiply"?this.setValue(this.value*tempBool%2):t=="Divide"&&this.setValue(this.value/tempBool%2)):this.vartype=="String"&&t=="Add"&&this.setValue(""+this.value+n)},Decvar.prototype.setValue=function(n){if(this.vartype=="Scientific"||this.vartype=="Decimal"||this.vartype=="Number")this.value=Number(n);else if(this.vartype=="Integer")this.value=Math.round(Number(n));else if(this.vartype=="Boolean")n=="true"||n=="True"||n=="TRUE"||n==!0?this.value=!0:(n=="false"||n=="False"||n=="FALSE"||n==!1)&&(this.value=!1);else if(this.vartype=="Enumerated")for(var t=0;t<this.members.length;t++)this.members[t]==n&&(this.value=n);else this.value=n;XMLMethods.setNodeText(this.resultsDocNode,this.value)},Decvar.prototype.truncate=function(){(this.vartype=="Integer"||this.vartype=="Scientific"||this.vartype=="Decimal")&&(this.vartype=="Integer"&&(this.value=Math.floor(this.value)),this.minvalue!=null&&this.value<this.minvalue&&(this.value=this.minvalue),this.maxvalue!=null&&this.value>this.maxvalue&&(this.value=this.maxvalue)),XMLMethods.setNodeText(this.resultsDocNode,this.value)},Decvar.prototype.getValue=function(){return this.value},Setvar.prototype.getVarname=function(){return this.varname},Setvar.prototype.getVarValue=function(){var n,t;return this.respident!=null&&this.respident!=""?this.index==-1?this.assessmentRef.getScoreAttribute(this.respident):(n=this.assessmentRef.getRespListAsArray(this.respident),n.length>this.index?n[this.index]:0):this.sourcevarname!=null&&this.sourcevarname!=""?t=this.assessmentRef.getScore(this.sourcevarname):this.textVal},Setvar.prototype.process=function(n){this.action=="ScoreSequence"?n.setValue(this.scoreSequenceQuestion(!1)):this.action=="ScoreSequencePartialCredit"?n.setValue(this.scoreSequenceQuestion(!0)):this.action=="ScoreMatching"?n.setValue(this.scoreMatchingQuestion(!1)):this.action=="ScoreMatchingPartialCredit"?n.setValue(this.scoreMatchingQuestion(!0)):this.action=="ScoreFIBFuzzy"?n.setValue(this.scoreFIBFuzzy(!1,!1)):this.action=="ScoreFIBFuzzyPartialCredit"?n.setValue(this.scoreFIBFuzzy(!0,!1)):this.action=="ScoreFIBFuzzyCaseSensitive"?n.setValue(this.scoreFIBFuzzy(!1,!0)):this.action=="ScoreFIBFuzzyPartialCreditCaseSensitive"?n.setValue(this.scoreFIBFuzzy(!0,!0)):this.action=="Set"?n.setValue(this.getVarValue()):n.setVarOp(this.getVarValue(),this.action)},Setvar.prototype.scoreFIBFuzzy=function(n,t){var o=Number(this.textVal),s=Number(this.errormargin),h=this.assessmentRef.getRespListAsArray(this.respident),f=h[0],r,i,u,e;for(t||(f=f.toLowerCase()),f=f.trim(),r=this.correctanswer.split(","),i=0,i=0;i<r.length;i++)r[i]=decodeURIComponent(r[i]),t||(r[i]=r[i].toLowerCase()),r[i]=r[i].trim();for(u=1e4,i=0;i<r.length;i++)e=(0+getDamerauLevenshteinDistance(r[i],f))/r[i].length,e<u&&(u=e);if(n){if(u<=(0+s)/100)return Math.round((1-u)*o)}else if(u<=(0+s)/100)return o;return 0},Setvar.prototype.scoreSequenceQuestion=function(n){for(var o=Number(this.textVal),s=this.assessmentRef.getRespListAsArray(this.respident),r=[],t=0,i,f,e,u,t=0;t<s.length;t++)r.push(s[t]);if(i=this.correctanswer.split(","),n){var h=0,c=0,l=0;for(t=0;t<i.length-1;t++)for(f=t+1;f<i.length;f++)if(l++,r.contains(i[t])&&r.contains(i[f]))for(e=0;e<r.length;e++)if(r[e]==i[t]){h++;break}else if(r[e]==i[f]){c++;break}return u=(h-c)/l*o,u=u<0?0:Math.round(u)}for(t=0;t<i.length;t++)if(r[t]!=i[t])return 0;return o},Setvar.prototype.scoreMatchingQuestion=function(n){for(var s=Number(this.textVal),h=this.assessmentRef.getRespListAsArray(this.respident),i=[],t=0,u,f,e,o,c,r,t=0;t<h.length;t++)i.push(h[t]);for(u=this.correctanswer.split(","),f=[],t=0;t<u.length;t=t+2)f[u[t]]=u[t+1];if(n){for(e=0,o=0,t=0;t<i.length;t=t+2)f[i[t]]==i[t+1]?e++:o++;return c=e+o,r=e/c*s,r=r<0?0:Math.round(r)}for(t=0;t<i.length;t=t+2)if(f[i[t]]!=i[t+1])return 0;return s},Outcomes.prototype.toString=function(){for(var t="",n=0;n<this.decvars.length;n++)t+=this.decvars[n].getName()+":"+this.decvars[n].getValue()+"<br/>";return t},Outcomes.prototype.getValue=function(n){for(var i=n.toLowerCase(),t=0;t<this.decvars.length;t++)if(this.decvars[t].getName()==i)return this.decvars[t].getValue()},Outcomes.prototype.processSetvars=function(n){for(var i,t=0;t<this.decvars.length;t++)for(i=0;i<n.length;i++)this.decvars[t].getName()==n[i].getVarname()&&n[i].process(this.decvars[t])},Outcomes.prototype.truncate=function(){for(var n=0;n<this.decvars.length;n++)this.decvars[n].truncate()},Outcomes.prototype.overwriteDecvar=function(n){for(var t=0;t<this.decvars.length;t++)if(this.decvars[t].getName()==n.getName())return this.decvars[t]=n,!0;return this.decvars.push(n),!0},Outcomes.prototype.size=function(){return this.decvars.length},Outcomes.prototype.getAt=function(n){return this.decvars[n]},TAvarequal.prototype.evaluate=this.evaluate,TAvarequal.prototype.testCondition=function(n,t){return t==n?!0:(n=n.toString(),t=t.toString(),t==n||this.caseInsensitive&&t.toLowerCase()==n.toLowerCase()||t.trim()==n.trim()||this.caseInsensitive&&t.toLowerCase().trim()==n.toLowerCase().trim())},TAvarlt.prototype.evaluate=this.evaluate,TAvarlt.prototype.testCondition=function(n,t){return Number(t)<Number(n)},TAvarlte.prototype.evaluate=this.evaluate,TAvarlte.prototype.testCondition=function(n,t){return Number(t)<=Number(n)},TAvargt.prototype.evaluate=this.evaluate,TAvargt.prototype.testCondition=function(n,t){return Number(n)<Number(t)},TAvargte.prototype.evaluate=this.evaluate,TAvargte.prototype.testCondition=function(n,t){return Number(t)>=Number(n)},TAdurequal.prototype.evaluate=this.evaluate,TAdurequal.prototype.testCondition=function(n,t,i){return Number(i)==Number(n)},TAdurlt.prototype.evaluate=this.evaluate,TAdurlt.prototype.testCondition=function(n,t,i){return Number(i)<Number(n)},TAdurlte.prototype.evaluate=this.evaluate,TAdurlte.prototype.testCondition=function(n,t,i){return Number(n)>=Number(i)},TAdurgt.prototype.evaluate=this.evaluate,TAdurgt.prototype.testCondition=function(n,t,i){return Number(n)<Number(i)},TAdurgte.prototype.evaluate=this.evaluate,TAdurgte.prototype.testCondition=function(n,t,i){return Number(i)>=Number(n)},TAvarsubstring.prototype.evaluate=this.evaluate,TAvarsubstring.prototype.testCondition=function(n,t){return t.indexOf(n)!=-1||this.caseInsensitive&&t.toLowerCase().indexOf(n.toLowerCase())!=-1?!0:!1},TAvarsubset.prototype.evaluate=this.evaluate,TAvarsubset.prototype.testCondition=function(n,t){for(var u=n.split(","),r=0;r<u.length;r++)if(t==u[r]||this.caseInsensitive&&t.toLowerCase()==u[r].toLowerCase())return!0;return!1},TAunanswered.prototype.evaluate=function(n){for(var r=0;r<n.length;r++)if(n[r][0]==this.respident)return n[r].length<2||n[r][1]==""?!0:!1},TAother.prototype.evaluate=function(){return!0},LogicAncestor.prototype.evaluate=function(){return!0},LAnot=function(n){SASuperConstruct(this,n)},LAnot.prototype.evaluate=function(n,t){for(var i=0;i<this.listOfBools.length;i++)if(this.listOfBools[i].evaluate(n,t))return!1;return!0},LAor=function(n){SASuperConstruct(this,n)},LAor.prototype.evaluate=function(n,t){for(var i=0;i<this.listOfBools.length;i++)if(this.listOfBools[i].evaluate(n,t))return!0;return!1},LAand=function(n){SASuperConstruct(this,n)},LAand.prototype.evaluate=function(n,t){for(var i=0;i<this.listOfBools.length;i++)if(!this.listOfBools[i].evaluate(n,t))return!1;return!0},ResponseProcessing.prototype.getFeedbackDisplay=function(){return this.feedbackDisplay},Respcondition.prototype.evaluate=function(n,t){var r=!1,i;if(r=this.condition!=null?this.condition.evaluate(n,this.assessmentRef):!0,r){for(t.processSetvars(this.setvars),i=0;i<this.branches.length;i++)this.branches[i].activate(this.assessmentRef);return this.shouldContinue=this.theContinue,this.displays}return this.shouldContinue=!0,[]},Respcondition.prototype.getShouldContinue=function(){return this.shouldContinue},matchingCSS='span.responselabeldynamic{    color: inherit;    text-decoration:none;    max-width: 280px;    display:block;}a.responselabeldynamic{    color: inherit;    text-decoration:none;    max-width: 280px;    display:block;}.responselabeldynamic{    position: absolute;}.renderflashcanvas{    position: relative;}.coordinatesystem{    position: relative;}.peg{\t-moz-border-radius: 10px;\tborder-radius: 10px;}.staticmatch{    position: relative;}.CQMatchingV1_1{    max-width:30%;}.choice_box {\tposition: relative;\tbackground: #eeeeee;    opacity: 0.5;\tborder: 1px solid #c2e1f5;}.choice_box:after, .choice_box:before {\tleft: 100%;\tborder: solid transparent;\tcontent: " ";\theight: 0;\twidth: 0;\tposition: absolute;\tpointer-events: none;}.choice_box:after {\tborder-left-color: #eeeeee;\tborder-width: 5px;\ttop: 50%;\tmargin-top: -5px;}.choice_box:before {\tborder-left-color: #c2e1f5;\tborder-width: 6px;\ttop: 50%;\tmargin-top: -6px;}.match_box {\tposition: relative;\tbackground: #eeeeee;    opacity: 0.5;\tborder: 1px solid #c2e1f5;}.match_box:after, .match_box:before {\tright: 100%;\tborder: solid transparent;\tcontent: " ";\theight: 0;\twidth: 0;\tposition: absolute;\tpointer-events: none;}.match_box:after {\tborder-right-color: #eeeeee;\tborder-width: 5px;\ttop: 50%;\tmargin-top: -5px;}.match_box:before {\tborder-right-color: #c2e1f5;\tborder-width: 6px;\ttop: 50%;\tmargin-top: -6px;}.stand_box {\tposition: relative;\tbackground: #ffffff;\topacity:0;\tborder: 1px solid #c2e1f5;}.stand_box:after, .stand_box:before {\tright: 100%;\tborder: solid transparent;\tcontent: " ";\theight: 0;\twidth: 0;\tposition: absolute;\tpointer-events: none;}.stand_box:after {\tborder-right-color: #88b7d5;\tborder-width: 0px;\ttop: 50%;\tmargin-top: -0px;}.stand_box:before {\tborder-right-color: #c2e1f5;\tborder-width: 1px;\ttop: 50%;\tmargin-top: -1px;}.correct_box {\tposition: relative;\tbackground: #ccffcc;\tborder: 1px solid #c2e1f5;}.correct_box:after, .stand_box:before {\tright: 100%;\tborder: solid transparent;\tcontent: " ";\theight: 0;\twidth: 0;\tposition: absolute;\tpointer-events: none;}.correct_box:after {\tborder-right-color: #88b7d5;\tborder-width: 0px;\ttop: 50%;\tmargin-top: -0px;}.correct_box:before {\tborder-right-color: #c2e1f5;\tborder-width: 1px;\ttop: 50%;\tmargin-top: -1px;}',QWUtils.addCss(matchingCSS),CQMatchingV1_1.prototype.isFullyAnswered=function(){return this.myPegBoard.getAnswers().contains("undefined")?!1:!0},CQMatchingV1_1.prototype.updateAnswers=function(n){for(var u=this.myPegBoard.getFixedChoices(),r=this.myPegBoard.getAnswers(),i=[],t=0;t<r.length;t++)i.push(this.idTable[u[t]].replace(this.respID,"")),r[t]!="undefined"?i.push(this.idTable[r[t]].replace(this.respID,"")):i.push("undefined");this.assessmentRef.setAnswers(this.respID,i,n)},CQMatchingV1_1.prototype.putAnswersInPlace=function(){var t,n,r,f,u,i;for(t=this.isFeedback?this.assessmentRef.getRespListAsArray(this.originalQuestionID):this.assessmentRef.getRespListAsArray(this.respID),n=0,n=0;n<t.length;n=n+2)t[n+1]!="undefined"&&this.myPegBoard.putSpanInAnswerID(this.assessmentRef.getNodeByID(this.idTable[this.respID+t[n+1]]),n/2);if(r=0,this.isFeedback)for(this.myPegBoard.setSpansInColumnVisibility(2,!1),f=this.assessmentRef.getNodeByID(this.respID),n=0;n<this.correctAnswerArray.length;n++)u=this.assessmentRef.getNodeByID(this.idTable[this.respID+this.correctAnswerArray[n*2+1]]),this.idTable[this.respID+this.correctAnswerArray[n*2+1]]!=undefined&&u!=null?(i=u.cloneNode(!0),i.style.visibility="visible",f.appendChild(i),this.myPegBoard.putCorrectAnswerInPlace(i,n-r)):r++},QWFIBV1_0.prototype.attachTextListener=function(n,t){window.addEventListener?(n.addEventListener("input",t,!1),n.addEventListener("blur",t,!1)):(n.attachEvent("onpropertychange",function(){t.call(n)}),n.attachEvent("onblur",function(){t.call(n)}))},QWFIBV1_0.prototype.isFullyAnswered=function(){var n=this.assessmentRef.getNodeByID(this.responseID).value;return n==null||n==""?!1:!0},QWFIBV1_0.prototype.updateAnswers=function(){var t=this.assessmentRef.getNodeByID(this.responseID).value,n=[];n.push(t),this.assessmentRef.setAnswers(this.responseID,n,!0)},QWFIBV1_0.prototype.putAnswersInPlace=function(){var n;n=this.isFeedback?this.assessmentRef.getRespListAsArray(this.responseID):this.assessmentRef.getAnswers(this.responseID),this.assessmentRef.getNodeByID(this.responseID).value=n[0]},QWClozeV1_0.prototype.putAnswersInPlace=function(){for(var i,t=this.isFeedback?this.assessmentRef.getRespListAsArray(this.originalQuestionID):this.assessmentRef.getRespListAsArray(this.respID),n=0;n<this.blanks;n++)i=this.assessmentRef.getNodeByID("fib"+n+this.respID),i!=null&&t[n]!=undefined&&(i.value=t[n])},QWClozeV1_0.prototype.updateAnswers=function(n){for(var i=[],r,t=0;t<this.blanks;t++)r=this.assessmentRef.getNodeByID("fib"+t+this.respID),i.push(r.value);this.assessmentRef.setAnswers(this.respID,i,n,this.getScore())},QWClozeV1_0.prototype.isFullyAnswered=function(){return this.userAttemptMade},QWClozeV1_0.prototype.getScore=function(){for(var t=0,o=this.maxPoints/this.blanks,f,n,i,u,e,r=0;r<this.blanks;r++){for(f=this.assessmentRef.getNodeByID("fib"+r+this.respID).value.trim(),n=this.answer[r],n==null&&(n=""),this.caseSensitive||(f=f.toLowerCase(),n=n.toLowerCase()),n=n.split(";"),i=1e4,u=0;u<n.length;u++)e=(0+getDamerauLevenshteinDistance(n[u],f))/n[u].length,e<i&&(i=e);this.allowPartialCredit?i<=(0+this.errorAllowed)/100&&(t=t+(1-i)*o):i<=(0+this.errorAllowed)/100&&(t=t+o)}return t>this.maxPoints&&(t=this.maxPoints),Math.round(t)},seqCSS='.CQSequencingV1_0{    max-width:48%;}.sequence_box {\tposition: relative;\tbackground: #eeeeee;    opacity: 0.5;\tborder: 1px solid #c2e1f5;}.sequence_box:after, .stand_box:before {\tright: 100%;\tborder: solid transparent;\tcontent: " ";\theight: 0;\twidth: 0;\tposition: absolute;\tpointer-events: none;}.sequence_box:after {\tborder-right-color: #eeeeee;\tborder-width: 0px;\ttop: 50%;\tmargin-top: -0px;}.sequence_box:before {\tborder-right-color: #c2e1f5;\tborder-width: 1px;\ttop: 50%;\tmargin-top: -1px;}.sequencenumber{\tcolor:#FFFFFF;}',QWUtils.addCss(seqCSS),CQSequencingV1_0.prototype.isFullyAnswered=function(){return this.myPegBoard.getAnswers().contains("undefined")?!1:!0},CQSequencingV1_0.prototype.updateAnswers=function(){for(var t=this.myPegBoard.getAnswers(),n=0;n<t.length;n++)t[n]!="undefined"&&(t[n]=this.idTable[t[n]].replace(this.respID,""));this.assessmentRef.setAnswers(this.respID,t,!0)},CQSequencingV1_0.prototype.putAnswersInPlace=function(){var t,n,r,u,i;for(t=this.isFeedback?this.assessmentRef.getRespListAsArray(this.originalQuestionID):this.assessmentRef.getRespListAsArray(this.respID),n=0,n=0;n<t.length;n++)t[n]!="undefined"&&this.myPegBoard.putSpanInAnswerID(this.assessmentRef.getNodeByID(this.idTable[this.respID+t[n]]),n);if(this.isFeedback)for(this.myPegBoard.setSpansInColumnVisibility(1,!1),r=this.assessmentRef.getNodeByID(this.respID),n=0;n<this.correctAnswerArray.length;n++)u=this.assessmentRef.getNodeByID(this.idTable[this.respID+this.correctAnswerArray[n]]),i=u.cloneNode(!0),i.style.visibility="visible",r.appendChild(i),this.myPegBoard.putCorrectAnswerInPlace(i,n)},Branch.prototype.activate=function(n){this.theURL!=null&&this.theURL!=""&&n.setForwardURL(this.theURL),this.newTarget!=null&&this.newTarget!=""&&n.setSeekBranch(this.newTarget,this.branchDirection)},PegBoard.prototype.addPeg=function(n,t,i,r){this.pegs.push(n),r&&this.fixedPegs.push(n),t&&this.answerPegs.push(n),i&&this.correctAnswerPegs.push(n)},PegBoard.prototype.addColumn=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){for(var b=t+this.padding*2,w=i+this.padding*2,k,p=0;p<n;p++)s!=null&&(k=s.shift()),this.addPeg(new Peg(this,this.xOffset+r,(w+5)*p,this.padding,"test"+p,this.theDiv,b,w,this.cornerRadius,this.lineWidth,u,f,e,o,k,h,c,this.columnNumber,v,p+1),l,a,y),this.xOffset+b>this.maxWidth&&(this.maxWidth=this.xOffset+b),(w+5)*(p+1)>this.maxHeight&&(this.maxHeight=(w+5)*(p+1));this.xOffset+=t+r+this.padding*2,this.columnNumber++},PegBoard.prototype.createSpacerCanvasForDocumentFlow=function(){var n=document.createElement("div");n.style.height=this.maxHeight+"px",n.style.width=this.maxWidth+"px",n.unselectable="on",n.id="spacer",this.theDiv.insertBefore(n,this.theDiv.firstChild),this.adjustForRTL()},PegBoard.prototype.adjustForRTL=function(){},PegBoard.prototype.handleDroppedSpan=function(n,t,i){this.putSpanInSlot(n,t,i),this.theQuestion.updateAnswers(!0)},PegBoard.prototype.putSpanInSlot=function(n,t,i){if(n.pegBoard!=i){alert("Cannot Drop Here. Different DnD Question.");return}if(!n.hasSpan()){for(var r=0;r<this.pegs.length;r++)this.pegs[r].getSpan()==t&&this.pegs[r].releaseSpan();n.setSpan(t)}this.selectedSpan!=null&&(this.selectedSpan.style.opacity=1,this.selectedSpan=null)},PegBoard.prototype.unselectAllSpans=function(){for(var n=0;n<this.draggableSpans.length;n++)this.draggableSpans[n].style.opacity=1},PegBoard.prototype.getFixedChoices=function(){for(var t=[],n=0;n<this.fixedPegs.length;n++)this.fixedPegs[n].hasSpan()?t.push(this.fixedPegs[n].span.id):t.push("undefined");return t},PegBoard.prototype.getAnswers=function(){for(var t=[],n=0;n<this.answerPegs.length;n++)this.answerPegs[n].hasSpan()?t.push(this.answerPegs[n].span.id):t.push("undefined");return t},PegBoard.prototype.putSpanInAnswerID=function(n,t){this.putSpanInSlot(this.answerPegs[t],n,this)},PegBoard.prototype.setSpansInColumnVisibility=function(n,t){for(var i=0;i<this.pegs.length;i++)this.pegs[i].getColumnNumber()==n&&(this.pegs[i].setSpanVisibility(t),this.pegs[i].releaseSpan())},PegBoard.prototype.putCorrectAnswerInPlace=function(n,t){n.pegBoard=this,this.putSpanInSlot(this.correctAnswerPegs[t],n,this)},PegBoard.prototype.setSelectedSpan=function(n){this.unselectAllSpans(),this.selectedSpan=n},PegBoard.prototype.getSelectedSpan=function(){return this.selectedSpan},PegBoard.prototype.getClosestEmptyPeg=function(n){for(var i=1e6,r=null,t=0;t<this.droppablePegs.length;t++)if(!this.droppablePegs[t].hasSpan()){var u=this.droppablePegs[t].xcoord-Number(n.style.left.split("px")[0]),f=this.droppablePegs[t].ycoord-Number(n.style.top.split("px")[0]),e=u*u+f*f;e<i&&(i=e,r=this.droppablePegs[t])}return r},Peg.prototype.setSpan=function(n){this.span=n,this.span.style.top=this.ycoord+this.pegBoard.padding*2+"px",this.span.style.left=this.xcoord+this.pegBoard.padding*2+"px"},Peg.prototype.hasSpan=function(){return this.span!=null},Peg.prototype.getSpan=function(){return this.span},Peg.prototype.releaseSpan=function(){this.span=null},Peg.prototype.getColumnNumber=function(){return this.colNumber},Peg.prototype.setSpanVisibility=function(n){this.span!=null&&(this.span.style.visibility=n?"visible":"hidden")}